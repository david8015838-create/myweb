<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Portfolio | Immersive Journey</title>
    <link rel="manifest" href="/manifest.json">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Playfair+Display:italic@400;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    
    <style>
        html { scroll-behavior: smooth; }
        @media (hover: hover) and (pointer: fine) {
            html { cursor: none; }
        }
        body { 
            background-color: #000; 
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(71,85,105,0.008) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(71,85,105,0.006) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(71,85,105,0.005) 0%, transparent 50%);
            background-size: 500% 500%, 500% 500%, 500% 500%;
            background-position: 0% 50%, 100% 50%, 50% 100%;
            animation: gradient-slide-bg-radial 30s ease infinite;
            background-attachment: fixed;
            color: #e5e5e5; 
            margin: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
        }
        
        @keyframes gradient-slide-bg-radial {
            0%, 100% {
                background-position: 0% 50%, 100% 50%, 50% 100%;
            }
            33% {
                background-position: 50% 0%, 50% 100%, 0% 50%;
            }
            66% {
                background-position: 100% 50%, 0% 50%, 100% 0%;
            }
        }

        /* 3D 容器 */
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; pointer-events: none; opacity: 0; display: none; }
        
        /* 自定義滑鼠 */
        #cursor-dot {
            width: 8px; height: 8px; background: white; border-radius: 50%;
            position: fixed; pointer-events: none; z-index: 9999;
            transform: translate(-50%, -50%); transition: width 0.3s, height 0.3s, background 0.3s;
            display: none;
        }
        #cursor-outline {
            width: 40px; height: 40px; border: 1px solid rgba(255,255,255,0.3); border-radius: 50%;
            position: fixed; pointer-events: none; z-index: 9998;
            transform: translate(-50%, -50%); transition: all 0.15s ease-out;
            display: none;
        }
        @media (hover: hover) and (pointer: fine) {
            #cursor-dot, #cursor-outline {
                display: block;
            }
        }

        /* 背景設計 */
        .bg-noise {
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.04; pointer-events: none;
        }
        .backdrop-blur-md { backdrop-filter: blur(20px); }
        .custom-scrollbar::-webkit-scrollbar { 
            width: 6px; 
        }
        .custom-scrollbar::-webkit-scrollbar-track { 
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            margin: 8px 0;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.25) 50%, rgba(255, 255, 255, 0.15) 100%);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: background 0.3s ease;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.35) 50%, rgba(255, 255, 255, 0.25) 100%);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }
        
        @keyframes gradient-slide {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        /* 金属光泽扫过效果 */
        @keyframes metal-shine {
            0% {
                background-position: -200% center;
            }
            50% {
                background-position: 200% center;
            }
            100% {
                background-position: -200% center;
            }
        }
        
        /* Portfolio 金属特效样式 */
        .portfolio-metal {
            position: relative;
            display: inline-block;
            background: linear-gradient(135deg, #ffffff 0%, #e8e8e8 25%, #c0c0c0 50%, #e8e8e8 75%, #ffffff 100%);
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: metal-shine 4s ease-in-out infinite;
            filter: drop-shadow(0 2px 4px rgba(255, 255, 255, 0.4));
        }
        
        .portfolio-metal::before {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.8) 50%, transparent 100%);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: metal-shine 3s ease-in-out infinite;
            mix-blend-mode: overlay;
            pointer-events: none;
        }
        
        /* 聚光燈效果 - 審訊室灰白聚光燈 */
        @keyframes spotlight-fade-in {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }
        
        .experience-spotlight {
            position: absolute;
            top: -20px;
            left: -30px;
            right: -30px;
            bottom: -20px;
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        
        .experience-spotlight.active {
            opacity: 1;
            animation: spotlight-fade-in 0.5s ease-in-out;
        }
        
        .experience-spotlight:not(.active) {
            opacity: 0;
        }
        
        .experience-spotlight::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120%;
            height: 100%;
            background: radial-gradient(ellipse at center, 
                rgba(255, 255, 255, 0.3) 0%,
                rgba(220, 220, 220, 0.2) 15%,
                rgba(200, 200, 200, 0.15) 25%,
                rgba(150, 150, 150, 0.1) 40%,
                rgba(100, 100, 100, 0.05) 55%,
                rgba(50, 50, 50, 0.02) 70%,
                transparent 85%);
            filter: blur(25px);
            pointer-events: none;
        }
        
        .experience-spotlight::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center, 
                transparent 0%,
                rgba(0, 0, 0, 0.2) 45%,
                rgba(0, 0, 0, 0.4) 70%,
                rgba(0, 0, 0, 0.6) 100%);
            pointer-events: none;
            mix-blend-mode: multiply;
        }
        
        /* 箭頭放大發光效果 - 白色光 */
        @keyframes arrow-glow {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
            }
            50% {
                transform: scale(1.6);
                filter: drop-shadow(0 0 25px rgba(255, 255, 255, 1)) drop-shadow(0 0 40px rgba(255, 255, 255, 0.9));
            }
        }
        
        .arrow-glow-active {
            animation: arrow-glow 2s ease-in-out infinite;
        }
        
        /* 3D卡牌輪播效果 */
        .cert-cards-container {
            perspective: 2000px;
            position: relative;
            width: 100%;
            min-height: 340px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
        }
        
        .cert-cards-wrapper {
            position: relative;
            width: 100%;
            max-width: 850px;
            height: 290px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .cert-card {
            position: absolute;
            width: 240px;
            height: 290px;
            transform-style: preserve-3d;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .cert-card-content {
            width: 100%;
            height: 100%;
            border-radius: 14px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.05) 50%,
                rgba(255, 255, 255, 0.08) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 
                inset 0 1px 3px 0 rgba(255, 255, 255, 0.2),
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            padding: 15px;
        }
        
        .cert-card-image {
            width: 100%;
            height: 145px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 10px;
            opacity: 0.5;
            filter: brightness(1.1);
        }
        
        .cert-card-image.rotate-left-90 {
            transform: rotate(-90deg);
        }
        
        .cert-card-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .cert-card-title {
            font-size: 16px;
            font-weight: 300;
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 5px;
        }
        
        .cert-card-issuer {
            font-size: 10px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 8px;
        }
        
        .cert-card-desc {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }
        
        .cert-card-badge {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 1px solid rgba(255, 215, 0, 0.5);
            background: rgba(255, 215, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 12px;
        }
        
        .cert-card-badge span {
            font-size: 10px;
            font-weight: 700;
            color: rgba(255, 215, 0, 0.9);
            text-transform: uppercase;
        }
        
        /* Project Matrix 3D 浮起降下动画 */
        @keyframes float-3d {
            0%, 100% {
                transform: translateY(-4px) translateZ(0) scale(1);
                box-shadow: inset 0 1px 2px 0 rgba(255,255,255,0.15), 0 12px 40px 0 rgba(0,0,0,0.5), 0 4px 20px 0 rgba(255,255,255,0.03);
            }
            50% {
                transform: translateY(-16px) translateZ(20px) scale(1.02);
                box-shadow: inset 0 1px 3px 0 rgba(255,255,255,0.2), 0 20px 60px 0 rgba(0,0,0,0.6), 0 8px 30px 0 rgba(255,255,255,0.08), 0 0 50px 0 rgba(255,255,255,0.1);
            }
        }
        
        .project-matrix-float {
            animation: float-3d 3s ease-in-out infinite;
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        /* 高级点击特效 */
        @keyframes click-effect {
            0% {
                transform: scale(1) translateZ(0);
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0), 0 0 0 0 rgba(96, 165, 250, 0), 0 0 0 0 rgba(167, 139, 250, 0);
            }
            50% {
                transform: scale(0.96) translateZ(0);
                box-shadow: 0 0 30px 10px rgba(255, 255, 255, 0.3), 
                           0 0 50px 15px rgba(96, 165, 250, 0.4), 
                           0 0 70px 20px rgba(167, 139, 250, 0.3);
            }
            100% {
                transform: scale(1) translateZ(0);
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0), 0 0 0 0 rgba(96, 165, 250, 0), 0 0 0 0 rgba(167, 139, 250, 0);
            }
        }
        
        @keyframes ripple-effect {
            0% {
                transform: translate3d(-50%, -50%, 0) scale(0);
                opacity: 0.8;
            }
            50% {
                opacity: 0.4;
            }
            100% {
                transform: translate3d(-50%, -50%, 0) scale(4);
                opacity: 0;
            }
        }
        
        @keyframes ripple-effect-2 {
            0% {
                transform: translate3d(-50%, -50%, 0) scale(0);
                opacity: 0.6;
            }
            50% {
                opacity: 0.3;
            }
            100% {
                transform: translate3d(-50%, -50%, 0) scale(6);
                opacity: 0;
            }
        }
        
        @keyframes particle-float {
            0% {
                transform: translate3d(-50%, -50%, 0) translate3d(0, 0, 0) scale(1);
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                transform: translate3d(-50%, -50%, 0) translate3d(var(--tx), var(--ty), 0) scale(0);
                opacity: 0;
            }
        }
        
        
        .click-effect {
            animation: click-effect 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            will-change: transform, box-shadow;
            transform: translateZ(0);
        }
        
        @keyframes gradient-shift {
            0% {
                background-position: 0% 50%;
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                background-position: 100% 50%;
                opacity: 0;
            }
        }
        
        .ripple-container {
            position: absolute;
            inset: 0;
            border-radius: inherit;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }
        
        .ripple-wave {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.4) 0%, rgba(96, 165, 250, 0.3) 30%, rgba(167, 139, 250, 0.2) 60%, transparent 100%);
            transform: translate(-50%, -50%);
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            z-index: 999;
            will-change: transform, opacity;
        }
        
        .glow-layer {
            will-change: transform, opacity;
            transform-origin: center;
        }
        
        .ripple-wave {
            will-change: transform, opacity;
            transform-origin: center;
            transform: translate3d(-50%, -50%, 0);
            backface-visibility: hidden;
        }
        
        /* 性能優化 - 強制GPU加速 */
        .ripple-container,
        .particle {
            will-change: transform, opacity;
            transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .ripple-container {
            pointer-events: none;
            position: absolute;
            inset: 0;
            overflow: hidden;
        }
        
        /* 手機適配 */
        @media (max-width: 768px) {
            body {
                overflow-x: hidden;
                width: 100%;
                position: relative;
            }
            * {
                max-width: 100vw;
                box-sizing: border-box;
            }
            #web-content {
                overflow-x: hidden;
            }
            main {
                overflow-x: hidden;
                width: 100%;
            }
            nav {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            nav .max-w-7xl {
                padding-left: 0;
                padding-right: 0;
            }
            nav .flex.items-center.gap-8 {
                gap: 0.5rem;
                flex-wrap: wrap;
            }
        }
        
        /* 防止模態框滾動穿透 */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }
        
        /* 確保關閉模態框後恢復滾動 */
        body:not(.modal-open) {
            overflow: auto;
            position: relative;
        }
    </style>
</head>
<body>
    <div id="cursor-dot"></div>
    <div id="cursor-outline"></div>
    <div id="canvas-container"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;
        const { motion, AnimatePresence, useScroll, useSpring, useInView } = window.Motion;

        const App = () => {
            const [stage, setStage] = useState('intro3d');
            const [waitingStart, setWaitingStart] = useState(true); // 初始狀態：等待辛普森動畫
            const [showTypewriter, setShowTypewriter] = useState(false); // 顯示打字機效果
            const [typewriterText1, setTypewriterText1] = useState(''); // 第一行文字
            const [typewriterText2, setTypewriterText2] = useState(''); // 第二行文字
            const [activeProjectModal, setActiveProjectModal] = useState(false);
            const [activeProjectView, setActiveProjectView] = useState(null);
            const [activeProjectInfo, setActiveProjectInfo] = useState(null); // 顯示項目功能介紹
            const [activeExpModal, setActiveExpModal] = useState(null);
            const [activeCertModal, setActiveCertModal] = useState(null);
            const [iframeScale, setIframeScale] = useState(0.85);
            const [journeyDescription, setJourneyDescription] = useState('');
            const journeyDescriptionRef = useRef(null);
            const journeySectionRef = useRef(null);
            const iframeRef = useRef(null);
            
            // 證照卡牌輪播相關狀態
            const [certPageIndex, setCertPageIndex] = useState(0);
            const [imagesLoaded, setImagesLoaded] = useState(false);
            const imagesLoadedRef = useRef(false);
            const certCardsContainerRef = useRef(null);

            // 圖片預載入函數
            const preloadImages = useCallback(async () => {
                const projectImages = projects.flatMap(p => p.images || []);
                const expImages = experiences.flatMap(e => e.images || []);
                const certImages = allCertificates.map(c => c.image).filter(Boolean);
                const staticImages = Object.values(IMAGES);
                
                const allUrls = [...new Set([...projectImages, ...expImages, ...certImages, ...staticImages])];
                
                const loadPromises = allUrls.map(url => {
                    return new Promise((resolve) => {
                        const img = new Image();
                        img.src = url;
                        img.onload = resolve;
                        img.onerror = resolve; // 即使出錯也繼續，避免卡死
                    });
                });

                await Promise.all(loadPromises);
                setImagesLoaded(true);
                imagesLoadedRef.current = true;
                console.log('All images preloaded');
            }, []);
            
            // 經歷描述的打字機效果
            const journeyInView = useInView(journeyDescriptionRef, { once: false, amount: 0.1 });
            // 經歷區塊的視口檢測（用於聚光燈效果）
            const journeySectionInView = useInView(journeySectionRef, { once: false, amount: 0.2 });
            
            // 證照滑動處理函數（無限循環）
            const handleCertSlide = (direction) => {
                setCertPageIndex(prev => {
                    if (direction === 'prev') {
                        // 如果是第一張，跳到最后一張
                        return prev === 0 ? allCertificates.length - 1 : prev - 1;
                    } else {
                        // 如果是最后一張，跳到第一張
                        return prev === allCertificates.length - 1 ? 0 : prev + 1;
                    }
                });
            };
            
            // 觸控板手勢支持（左右滑動）+ 手機觸摸滑動支持
            useEffect(() => {
                const container = certCardsContainerRef.current;
                if (!container) return;
                
                let wheelTimeout = null;
                let wheelDeltaX = 0;
                let lastSlideTime = 0;
                const SLIDE_COOLDOWN = 600; // 每次切換後至少等待600ms才能再次切換
                const TRIGGER_THRESHOLD = 150; // 提高觸發閾值，需要更大的滑動距離
                
                // 觸控板手勢處理
                const handleWheel = (e) => {
                    // 檢測水平滾動（觸控板左右滑動）
                    if (Math.abs(e.deltaX) > Math.abs(e.deltaY)) {
                        e.preventDefault();
                        
                        const now = Date.now();
                        
                        // 節流：檢查是否在冷卻期內
                        if (now - lastSlideTime < SLIDE_COOLDOWN) {
                            return;
                        }
                        
                        wheelDeltaX += e.deltaX;
                        
                        // 防抖：累積滑動距離，超過更高的閾值才觸發
                        if (Math.abs(wheelDeltaX) > TRIGGER_THRESHOLD) {
                            setCertPageIndex(prev => {
                                const total = certificateGroups.flatMap(group => group.items).length;
                                if (wheelDeltaX > 0) {
                                    // 向右滑動 = 上一張
                                    return prev === 0 ? total - 1 : prev - 1;
                                } else {
                                    // 向左滑動 = 下一張
                                    return prev === total - 1 ? 0 : prev + 1;
                                }
                            });
                            wheelDeltaX = 0;
                            lastSlideTime = now;
                        }
                        
                        // 重置累積值（延長時間）
                        if (wheelTimeout) clearTimeout(wheelTimeout);
                        wheelTimeout = setTimeout(() => {
                            wheelDeltaX = 0;
                        }, 300);
                    }
                };
                
                // 手機觸摸滑動處理
                let touchStartX = 0;
                let touchStartY = 0;
                let touchMoved = false;
                const TOUCH_THRESHOLD = 50; // 觸摸滑動閾值（像素）
                
                const handleTouchStart = (e) => {
                    touchStartX = e.touches[0].clientX;
                    touchStartY = e.touches[0].clientY;
                    touchMoved = false;
                };
                
                const handleTouchMove = (e) => {
                    if (!touchStartX) return;
                    
                    const touchCurrentX = e.touches[0].clientX;
                    const touchCurrentY = e.touches[0].clientY;
                    const deltaX = touchCurrentX - touchStartX;
                    const deltaY = touchCurrentY - touchStartY;
                    
                    // 檢測水平滑動（水平移動大於垂直移動）
                    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 10) {
                        touchMoved = true;
                        e.preventDefault(); // 防止頁面滾動
                    }
                };
                
                const handleTouchEnd = (e) => {
                    if (!touchStartX || !touchMoved) {
                        touchStartX = 0;
                        return;
                    }
                    
                    const touchEndX = e.changedTouches[0].clientX;
                    const deltaX = touchEndX - touchStartX;
                    
                    const now = Date.now();
                    
                    // 節流：檢查是否在冷卻期內
                    if (now - lastSlideTime < SLIDE_COOLDOWN) {
                        touchStartX = 0;
                        return;
                    }
                    
                    // 如果滑動距離超過閾值，觸發切換
                    if (Math.abs(deltaX) > TOUCH_THRESHOLD) {
                        setCertPageIndex(prev => {
                            const total = certificateGroups.flatMap(group => group.items).length;
                            if (deltaX > 0) {
                                // 向右滑動 = 上一張
                                return prev === 0 ? total - 1 : prev - 1;
                            } else {
                                // 向左滑動 = 下一張
                                return prev === total - 1 ? 0 : prev + 1;
                            }
                        });
                        lastSlideTime = now;
                    }
                    
                    touchStartX = 0;
                    touchMoved = false;
                };
                
                container.addEventListener('wheel', handleWheel, { passive: false });
                container.addEventListener('touchstart', handleTouchStart, { passive: true });
                container.addEventListener('touchmove', handleTouchMove, { passive: false });
                container.addEventListener('touchend', handleTouchEnd, { passive: true });
                
                return () => {
                    container.removeEventListener('wheel', handleWheel);
                    container.removeEventListener('touchstart', handleTouchStart);
                    container.removeEventListener('touchmove', handleTouchMove);
                    container.removeEventListener('touchend', handleTouchEnd);
                    if (wheelTimeout) clearTimeout(wheelTimeout);
                };
            }, [certificateGroups]);
            
            useEffect(() => {
                const text = "Connecting the dots of experience to foster a vision that stops learning.";
                
                if (!journeyInView) {
                    setJourneyDescription('');
                    return;
                }
                
                let index = 0;
                setJourneyDescription('');
                const interval = setInterval(() => {
                    if (index < text.length) {
                        setJourneyDescription(text.substring(0, index + 1));
                        index++;
                    } else {
                        clearInterval(interval);
                    }
                }, 10); // 每個字10ms，更快速顯示
                
                return () => clearInterval(interval);
            }, [journeyInView]);
            
            // 根據屏幕大小動態調整iframe縮放
            useEffect(() => {
                const updateScale = () => {
                    const isMobile = window.innerWidth < 1024; // lg breakpoint
                    
                    if (isMobile) {
                        // 手機：使用較小的縮放，讓內容完整顯示
                        setIframeScale(0.85);
                    } else {
                        // 電腦：使用與手機相同的縮放比例，確保內容完整顯示
                        // 這樣可以確保在電腦上也能看到完整的小程序內容
                        setIframeScale(0.85);
                    }
                };
                
                updateScale();
                window.addEventListener('resize', updateScale);
                return () => window.removeEventListener('resize', updateScale);
            }, [activeProjectView]);

            // ESC 鍵處理：返回 Project Matrix 頁面
            useEffect(() => {
                const handleEscKey = (e) => {
                    if (e.key === 'Escape' && activeProjectView) {
                        // 返回 Project Matrix 頁面
                        setActiveProjectView(null);
                        setActiveProjectModal(true);
                        setTimeout(() => {
                            document.body.classList.remove('modal-open');
                            document.body.style.overflow = '';
                            document.body.style.position = '';
                            document.body.style.width = '';
                            document.body.style.height = '';
                        }, 100);
                    }
                };
                
                if (activeProjectView) {
                    window.addEventListener('keydown', handleEscKey);
                    return () => window.removeEventListener('keydown', handleEscKey);
                }
            }, [activeProjectView]);

            // 注入預設數據到小程序 - 直接寫入 localStorage
            useEffect(() => {
                if (!activeProjectView || !activeProjectView.demoData) return;

                const injectDemoData = () => {
                    const iframe = iframeRef.current;
                    if (!iframe) return;

                    try {
                        // 方式1: 通過 postMessage 發送數據（多次重試確保成功）
                        const sendData = () => {
                            try {
                                iframe.contentWindow.postMessage({
                                    type: 'LOAD_DEMO_DATA',
                                    source: 'portfolio-demo',
                                    data: activeProjectView.demoData,
                                    projectId: activeProjectView.id,
                                    projectTitle: activeProjectView.title
                                }, '*');
                            } catch (e) {
                                console.log('postMessage 發送失敗:', e);
                            }
                        };

                        // 立即發送
                        sendData();
                        
                        // 延遲發送多次，確保小程序已初始化
                        const delays = [500, 1000, 2000, 3000, 5000];
                        delays.forEach(delay => {
                            setTimeout(sendData, delay);
                        });

                        // 方式2: 嘗試直接訪問 localStorage（如果同源或允許）
                        const tryDirectStorage = () => {
                            try {
                                const iframeWindow = iframe.contentWindow;
                                if (iframeWindow && iframeWindow.localStorage) {
                                    // 根據不同項目存儲不同的數據
                                    if (activeProjectView.id === 1) {
                                        // Ledger App - 使用小程序可能使用的 key
                                        const storageKeys = [
                                            'ledger-budget', 'ledger-transactions', 'ledger-creditCards', 
                                            'ledger-recurringTransactions', 'ledger-data', 'ledger-app-data',
                                            'budget', 'transactions', 'creditCards', 'recurringTransactions'
                                        ];
                                        
                                        // 嘗試多種可能的 key 格式
                                        iframeWindow.localStorage.setItem('ledger-budget', JSON.stringify(activeProjectView.demoData.budget));
                                        iframeWindow.localStorage.setItem('ledger-transactions', JSON.stringify(activeProjectView.demoData.transactions));
                                        iframeWindow.localStorage.setItem('ledger-creditCards', JSON.stringify(activeProjectView.demoData.creditCards));
                                        iframeWindow.localStorage.setItem('ledger-recurringTransactions', JSON.stringify(activeProjectView.demoData.recurringTransactions));
                                        iframeWindow.localStorage.setItem('ledger-data', JSON.stringify(activeProjectView.demoData));
                                        iframeWindow.localStorage.setItem('ledger-demo-loaded', 'true');
                                    } else if (activeProjectView.id === 2) {
                                        // StockLens
                                        iframeWindow.localStorage.setItem('stocklens-assets', JSON.stringify(activeProjectView.demoData.assets));
                                        iframeWindow.localStorage.setItem('stocklens-compoundInterest', JSON.stringify(activeProjectView.demoData.compoundInterest));
                                        iframeWindow.localStorage.setItem('stocklens-data', JSON.stringify(activeProjectView.demoData));
                                        iframeWindow.localStorage.setItem('stocklens-demo-loaded', 'true');
                                        // 也嘗試其他可能的 key
                                        iframeWindow.localStorage.setItem('assets', JSON.stringify(activeProjectView.demoData.assets));
                                        iframeWindow.localStorage.setItem('compoundInterest', JSON.stringify(activeProjectView.demoData.compoundInterest));
                                    } else if (activeProjectView.id === 3) {
                                        // SplitWise Pro
                                        iframeWindow.localStorage.setItem('splitwise-roomId', activeProjectView.demoData.roomId);
                                        iframeWindow.localStorage.setItem('splitwise-roomName', activeProjectView.demoData.roomName);
                                        iframeWindow.localStorage.setItem('splitwise-members', JSON.stringify(activeProjectView.demoData.members));
                                        iframeWindow.localStorage.setItem('splitwise-expenses', JSON.stringify(activeProjectView.demoData.expenses));
                                        iframeWindow.localStorage.setItem('splitwise-settlements', JSON.stringify(activeProjectView.demoData.settlements));
                                        iframeWindow.localStorage.setItem('splitwise-data', JSON.stringify(activeProjectView.demoData));
                                        iframeWindow.localStorage.setItem('splitwise-demo-loaded', 'true');
                                        // 也嘗試其他可能的 key
                                        iframeWindow.localStorage.setItem('roomId', activeProjectView.demoData.roomId);
                                        iframeWindow.localStorage.setItem('members', JSON.stringify(activeProjectView.demoData.members));
                                        iframeWindow.localStorage.setItem('expenses', JSON.stringify(activeProjectView.demoData.expenses));
                                    }
                                    console.log('數據已成功寫入 localStorage');
                                }
                            } catch (e) {
                                // 跨域限制，無法直接訪問 localStorage
                                console.log('無法直接訪問 iframe localStorage（跨域限制），使用 postMessage 方式');
                            }
                        };

                        // 嘗試直接寫入，多次重試
                        tryDirectStorage();
                        setTimeout(tryDirectStorage, 1000);
                        setTimeout(tryDirectStorage, 2000);
                        setTimeout(tryDirectStorage, 3000);

                        // 方式3: 通過 URL 參數傳遞（已在 iframe src 中處理）
                    } catch (error) {
                        console.log('注入數據時發生錯誤:', error);
                    }
                };

                // 監聽 iframe 加載完成
                const iframe = iframeRef.current;
                if (iframe) {
                    const handleLoad = () => {
                        // 延遲注入，確保小程序已完全加載
                        setTimeout(injectDemoData, 500);
                        setTimeout(injectDemoData, 1500);
                        setTimeout(injectDemoData, 3000);
                    };

                    if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {
                        // 已經加載完成，直接注入
                        handleLoad();
                    } else {
                        // 等待加載完成
                        iframe.addEventListener('load', handleLoad);
                        return () => {
                            iframe.removeEventListener('load', handleLoad);
                        };
                    }
                }
            }, [activeProjectView]);

            const threeInstance = useRef({ scene: null, camera: null, renderer: null, tv: null, noiseCanvas: null, noiseTex: null, noiseCtx: null, staticActive: false });
            const staticCanvasRef = useRef(null);
            const staticAnimRef = useRef(null);
            const staticCtxRef = useRef(null);

            useEffect(() => {
                const container = document.getElementById('canvas-container');
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x050608);
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(0, 2.5, 6.8);
                camera.lookAt(-0.8, 1.5, 0.3);
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                container.appendChild(renderer.domElement);
                scene.add(new THREE.AmbientLight(0xffffff, 0.2));
                const tv = new THREE.Group();
                const frame = new THREE.Mesh(new THREE.BoxGeometry(3.6, 2, 0.1), new THREE.MeshStandardMaterial({ color: 0x000000 }));
                const screen = new THREE.Mesh(new THREE.PlaneGeometry(3.4, 1.8), new THREE.MeshBasicMaterial({ color: 0x000000 }));
                screen.position.z = 0.06;
                screen.name = "screen";
                tv.add(frame, screen);
                tv.position.set(-0.8, 1.5, 0.3);
                scene.add(tv);
                const floor = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), new THREE.MeshStandardMaterial({ color: 0x050505, roughness: 0.9, metalness: 0.0 }));
                floor.rotation.x = -Math.PI / 2;
                scene.add(floor);
                const wallBack = new THREE.Mesh(new THREE.PlaneGeometry(20, 10), new THREE.MeshStandardMaterial({ color: 0xead59e }));
                wallBack.position.set(0, 2.5, -1);
                wallBack.rotation.y = Math.PI;
                scene.add(wallBack);
                const rug = new THREE.Mesh(new THREE.PlaneGeometry(6, 3.5), new THREE.MeshStandardMaterial({ color: 0x5ec6e8 }));
                rug.rotation.x = -Math.PI / 2;
                rug.position.set(0, 0.01, 3.2);
                scene.add(rug);
                const teaWood = new THREE.MeshStandardMaterial({ color: 0x7a4a2a, roughness: 0.8 });
                const teaTable = new THREE.Group();
                const teaTop = new THREE.Mesh(new THREE.CylinderGeometry(0.6, 0.6, 0.06, 24), teaWood);
                const teaPedestal = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, 0.5, 16), teaWood);
                teaTop.position.y = 0;
                teaPedestal.position.y = -0.25;
                teaTable.add(teaTop, teaPedestal);
                teaTable.position.set(-0.2, 0.52, 3.0);
                scene.add(teaTable);
                const matBase = new THREE.MeshStandardMaterial({ color: 0x2b5d3b, roughness: 0.7, metalness: 0.0 });
                const matCushion = new THREE.MeshStandardMaterial({ color: 0x3c6e47, roughness: 0.75, metalness: 0.0 });
                const matWood = new THREE.MeshStandardMaterial({ color: 0x7a4a2a, roughness: 0.8 });
                const sofa = new THREE.Group();
                const seatBase = new THREE.Mesh(new THREE.BoxGeometry(3.05, 0.35, 1.45), matBase);
                seatBase.position.y = 0.35;
                const cushionL = new THREE.Mesh(new THREE.BoxGeometry(1.5, 0.28, 1.4), matCushion);
                cushionL.position.set(-0.77, 0.62, 0);
                const cushionR = cushionL.clone();
                cushionR.position.x = 0.77;
                const bulgeL = new THREE.Mesh(new THREE.SphereGeometry(0.22, 24, 16), matCushion);
                bulgeL.scale.set(1.3, 0.5, 1.2);
                bulgeL.position.set(-0.77, 0.78, 0);
                const bulgeR = bulgeL.clone();
                bulgeR.position.x = 0.77;
                const backL = new THREE.Mesh(new THREE.BoxGeometry(1.5, 0.75, 0.32), matBase);
                backL.position.set(-0.77, 1.1, -0.6);
                const backR = backL.clone();
                backR.position.x = 0.77;
                const armBodyL = new THREE.Mesh(new THREE.CylinderGeometry(0.22, 0.22, 1.5, 20), matBase);
                armBodyL.rotation.z = Math.PI / 2;
                armBodyL.position.set(-1.72, 0.62, 0);
                const armFrontL = new THREE.Mesh(new THREE.SphereGeometry(0.28, 24, 16), matBase);
                armFrontL.position.set(-1.92, 0.62, 0.45);
                const armBodyR = armBodyL.clone();
                armBodyR.position.x = 1.72;
                const armFrontR = armFrontL.clone();
                armFrontR.position.x = 1.92;
                const legPositions = [
                    [-1.35, 0.1, 0.6], [1.35, 0.1, 0.6],
                    [-1.35, 0.1, -0.6], [1.35, 0.1, -0.6]
                ];
                const legs = legPositions.map(p => {
                    const leg = new THREE.Mesh(new THREE.CylinderGeometry(0.09, 0.11, 0.22, 12), matWood);
                    leg.position.set(p[0], p[1], p[2]);
                    return leg;
                });
                const pillow = new THREE.Mesh(new THREE.BoxGeometry(0.6, 0.2, 0.35), matCushion);
                pillow.position.set(0.25, 0.9, 0.25);
                pillow.rotation.z = -0.2;
                sofa.add(seatBase, cushionL, cushionR, bulgeL, bulgeR, backL, backR, armBodyL, armFrontL, armBodyR, armFrontR, pillow, ...legs);
                sofa.position.set(0, 0, 4);
                sofa.rotation.y = Math.PI;
                scene.add(sofa);
                const person = new THREE.Group();
                person.add(new THREE.Mesh(new THREE.CylinderGeometry(0.3, 0.4, 1), new THREE.MeshStandardMaterial({ color: 0x0a0a0a })));
                const head = new THREE.Mesh(new THREE.SphereGeometry(0.25), new THREE.MeshStandardMaterial({ color: 0x0a0a0a }));
                head.position.y = 0.7;
                person.add(head);
                person.position.set(-0.6, 0.9, 4.1);
                person.rotation.y = Math.PI;
                scene.add(person);
                const noiseCanvas = document.createElement('canvas');
                noiseCanvas.width = 256;
                noiseCanvas.height = 128;
                const noiseCtx = noiseCanvas.getContext('2d');
                const noiseTex = new THREE.CanvasTexture(noiseCanvas);
                noiseTex.wrapS = THREE.ClampToEdgeWrapping;
                noiseTex.wrapT = THREE.ClampToEdgeWrapping;
                noiseTex.minFilter = THREE.NearestFilter;
                noiseTex.magFilter = THREE.NearestFilter;
                threeInstance.current = { scene, camera, renderer, tv, noiseCanvas, noiseTex, noiseCtx, staticActive: false };
                const animate = () => {
                    requestAnimationFrame(animate);
                    if (threeInstance.current.staticActive && threeInstance.current.noiseCtx) {
                        const ctx = threeInstance.current.noiseCtx;
                        const w = threeInstance.current.noiseCanvas.width;
                        const h = threeInstance.current.noiseCanvas.height;
                        const imgData = ctx.createImageData(w, h);
                        for (let i = 0; i < imgData.data.length; i += 4) {
                            const v = Math.random() * 255;
                            imgData.data[i] = v;
                            imgData.data[i + 1] = v;
                            imgData.data[i + 2] = v;
                            imgData.data[i + 3] = 255;
                        }
                        ctx.putImageData(imgData, 0, 0);
                        threeInstance.current.noiseTex.needsUpdate = true;
                    }
                    renderer.render(scene, camera);
                };
                animate();
                const handleResize = () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                };
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            // 監聽辛普森動畫完成事件
            useEffect(() => {
                // 開始預載入圖片
                preloadImages();

                const setupStaticCanvas = () => {
                    const cvs = document.getElementById('static-overlay');
                    staticCanvasRef.current = cvs;
                    if (!cvs) return;
                    const resize = () => {
                        cvs.width = window.innerWidth;
                        cvs.height = window.innerHeight;
                    };
                    resize();
                    window.addEventListener('resize', resize);
                    return () => window.removeEventListener('resize', resize);
                };
                const teardownResize = setupStaticCanvas();
                const startStaticNoise = () => {
                    const cvs = staticCanvasRef.current;
                    if (!cvs) return;
                    const ctx = cvs.getContext('2d');
                    staticCtxRef.current = ctx;
                    const draw = () => {
                        const w = cvs.width, h = cvs.height;
                        const img = ctx.createImageData(w, h);
                        const data = img.data;
                        for (let i = 0; i < data.length; i += 4) {
                            const v = (Math.random() * 255) | 0;
                            data[i] = v;
                            data[i + 1] = v;
                            data[i + 2] = v;
                            data[i + 3] = 255;
                        }
                        ctx.putImageData(img, 0, 0);
                        staticAnimRef.current = requestAnimationFrame(draw);
                    };
                    draw();
                };
                const stopStaticNoise = () => {
                    if (staticAnimRef.current) {
                        cancelAnimationFrame(staticAnimRef.current);
                        staticAnimRef.current = null;
                    }
                };
                // 打字機效果函數
                const typewriterEffect = (text, setText, delay = 0, speed = 100) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            let index = 0;
                            const interval = setInterval(() => {
                                if (index < text.length) {
                                    setText(text.substring(0, index + 1));
                                    index++;
                                } else {
                                    clearInterval(interval);
                                    resolve();
                                }
                            }, speed); // 每個字的速度（毫秒）
                        }, delay);
                    });
                };

                const onMessage = (ev) => {
                    console.log('Received message:', ev.data);
                    if (ev.data === 'simpson-finished') {
                        console.log('Starting typewriter sequence...');
                        // 隱藏辛普森動畫
                        setWaitingStart(false);
                        gsap.set("#simpson-overlay", { display: 'none', opacity: 0 });
                        gsap.set("#canvas-container", { display: 'none', opacity: 0 });
                        gsap.set("#static-overlay", { display: 'none', opacity: 0 });
                        
                        // 顯示全黑屏幕和打字機效果
                        setShowTypewriter(true);
                        
                        // 開始打字機效果
                        (async () => {
                            // 第一行：HI! MY NAME IS OWEN
                            await typewriterEffect('HI! MY NAME IS OWEN', setTypewriterText1, 500, 25);
                            // 等待一下再開始第二行
                            await new Promise(resolve => setTimeout(resolve, 250));
                            // 第二行：WELCOME TO MY PORTFOLIO
                            await typewriterEffect('WELCOME TO MY PORTFOLIO', setTypewriterText2, 0);
                            // 等待一下再切換到個人網頁，並確保圖片已載入
                            await new Promise(resolve => setTimeout(resolve, 500));
                            
                            // 額外等待圖片載入完成（最多再等 2 秒）
                            let waitCount = 0;
                            while (!imagesLoadedRef.current && waitCount < 20) {
                                await new Promise(resolve => setTimeout(resolve, 100));
                                waitCount++;
                            }
                            
                            // 淡出打字機效果
                            gsap.to("#typewriter-overlay", {
                                opacity: 0,
                                duration: 0.4,
                                ease: "power2.in",
                                onComplete: () => {
                                    setShowTypewriter(false);
                                    // 切換到個人網頁
                                    setStage('web');
                                    document.body.style.overflow = 'auto';
                                    gsap.set("#web-content", { display: 'block' });
                                    gsap.to("#web-content", { 
                                        opacity: 1, 
                                        duration: 0.1,
                                        ease: "none"
                                    });
                                }
                            });
                        })();
                    }
                };
                window.addEventListener('message', onMessage);
                return () => {
                    window.removeEventListener('message', onMessage);
                    if (teardownResize) teardownResize();
                };
            }, []);

            const start3DSequence = () => {
                console.log('start3DSequence called, threeInstance.current:', threeInstance.current);
                setStage('intro3d');
                const { camera, tv, noiseTex, scene } = threeInstance.current;
                if (!camera || !tv || !noiseTex || !scene) {
                    console.error('Missing 3D objects:', { camera, tv, noiseTex, scene });
                    return;
                }
                console.log('Starting 3D animation sequence...');
                
                    const screen = tv.getObjectByName('screen');
                if (!screen) return;
                
                // 設置屏幕為雜訊材質
                screen.material = new THREE.MeshBasicMaterial({ color: 0xaaaaaa, map: noiseTex });
                    threeInstance.current.staticActive = true;
                
                // 添加電視發光效果（點光源）
                let tvLight = scene.getObjectByName('tvLight');
                if (!tvLight) {
                    tvLight = new THREE.PointLight(0xffffff, 0, 10);
                    tvLight.position.copy(tv.position);
                    tvLight.position.z += 0.5;
                    tvLight.name = 'tvLight';
                    scene.add(tvLight);
                }
                
                // 獲取電視屏幕的中心位置（世界座標）
                const screenCenter = new THREE.Vector3();
                screen.getWorldPosition(screenCenter);
                
                // 保存初始相機位置和朝向
                const initialPos = camera.position.clone();
                const initialLookAt = new THREE.Vector3(-0.8, 1.5, 0.3);
                
                const timeline = gsap.timeline({ defaults: { ease: "power2.inOut" } });
                
                // 階段1: 屏幕開始發光，雜訊變亮
                timeline.to(screen.material.color, { 
                    r: 1.0,
                    g: 1.0,
                    b: 1.0,
                    duration: 0.6,
                    ease: "power2.out"
                });
                timeline.to(tvLight, { 
                    intensity: 3,
                    duration: 0.6,
                    ease: "power2.out"
                }, "<");
                
                // 同時讓相機開始朝向屏幕中心
                timeline.to({}, {
                    duration: 0.6,
                    onUpdate: function() {
                        const progress = this.progress();
                        const lookAt = new THREE.Vector3().lerpVectors(initialLookAt, screenCenter, progress);
                        camera.lookAt(lookAt);
                    }
                }, "<");
                
                // 階段2: 鏡頭開始移動向電視屏幕
                timeline.to(camera.position, { 
                    x: screenCenter.x,
                    y: screenCenter.y,
                    z: screenCenter.z + 0.8, // 先到屏幕前方
                    duration: 1.5,
                    ease: "power2.inOut"
                }, "<0.3");
                
                // 確保相機持續朝向屏幕中心
                timeline.to({}, {
                    duration: 1.5,
                    onUpdate: function() {
                        camera.lookAt(screenCenter);
                    }
                }, "<");
                
                // 階段3: 屏幕變得更亮，雜訊更強烈
                timeline.to(screen.material.color, {
                    r: 1.5,
                    g: 1.5,
                    b: 1.5,
                    duration: 0.4
                });
                timeline.to(tvLight, {
                    intensity: 8,
                    duration: 0.4
                }, "<");
                
                // 階段4: 鏡頭鑽入屏幕中心（繼續推進）- 電腦版需要更深入，完全鑽進去看不到邊框
                const isMobile = window.innerWidth <= 768;
                // 增加鑽入深度：手機版從 -0.2 增加到 -0.5，電腦版從 -1.2 增加到 -2.5
                // 同時調整 X 和 Y 偏移，確保鏡頭正對屏幕中心
                const finalZ = isMobile ? screenCenter.z - 0.5 : screenCenter.z - 2.5; 
                timeline.to(camera.position, {
                    x: screenCenter.x - 0.1, // 微調 X 軸偏移，對準屏幕中心
                    y: screenCenter.y + 0.05, // 微調 Y 軸偏移
                    z: finalZ, // 鑽入屏幕，完全進入內部
                    duration: 1.5,
                    ease: "power3.in"
                }, "<0.2");
                
                // 持續朝向屏幕中心
                timeline.to({}, {
                    duration: 1.2,
                    onUpdate: function() {
                        camera.lookAt(screenCenter);
                    }
                }, "<");
                
                // 階段5: 持續朝向屏幕中心，確保完全鑽入
                timeline.to({}, {
                    duration: 1.5,
                    onUpdate: function() {
                        camera.lookAt(screenCenter);
                    }
                }, "<");
                
                // 階段6: 屏幕達到最亮，準備切換（給一點時間確保完全進入）
                timeline.to(screen.material.color, {
                    r: 2.0,
                    g: 2.0,
                    b: 2.0,
                    duration: 0.5
                });
                timeline.to(tvLight, {
                    intensity: 12,
                    duration: 0.5
                }, "<");
                
                // 階段7: 切換到個人網頁（在完全鑽入後）
                timeline.call(() => {
                    setStage('web');
                    document.body.style.overflow = 'auto';
                    threeInstance.current.staticActive = false;
                    // 淡出3D場景
                    gsap.to("#canvas-container", { 
                        opacity: 0, 
                        duration: 0.5,
                        onComplete: () => {
                            gsap.set("#canvas-container", { display: 'none' });
                        }
                    });
                    // 淡入個人網頁
                    gsap.set("#web-content", { display: 'block' });
                    gsap.to("#web-content", { 
                        opacity: 1, 
                        duration: 0.1 
                    });
                });
            };

            // 優化後的點擊特效處理函數（性能優化）
            const handleClickEffect = (e) => {
                const element = e.currentTarget;
                if (!element) return;
                
                // 防止快速重複點擊
                if (element.dataset.animating === 'true') return;
                element.dataset.animating = 'true';
                
                // 使用requestAnimationFrame優化
                requestAnimationFrame(() => {
                    // 添加點擊動畫類（簡單高效）
                    element.classList.add('click-effect');
                    
                    // 獲取點擊位置（支持觸摸設備）
                    const clientX = e.clientX || (e.touches && e.touches[0]?.clientX) || 0;
                    const clientY = e.clientY || (e.touches && e.touches[0]?.clientY) || 0;
                    const rect = element.getBoundingClientRect();
                    const x = clientX - rect.left;
                    const y = clientY - rect.top;
                    const size = Math.max(rect.width, rect.height);
                    
                    // 確保元素有相對定位和overflow
                    const originalPosition = window.getComputedStyle(element).position;
                    const originalOverflow = window.getComputedStyle(element).overflow;
                    const needsPosition = originalPosition === 'static';
                    const needsOverflow = originalOverflow === 'visible';
                    
                    if (needsPosition) {
                        element.style.position = 'relative';
                    }
                    if (needsOverflow) {
                        element.style.overflow = 'hidden';
                    }
                    
                    // 創建波紋容器（單一容器，減少DOM操作）
                    let rippleContainer = element.querySelector('.ripple-container');
                    if (!rippleContainer) {
                        rippleContainer = document.createElement('div');
                        rippleContainer.className = 'ripple-container';
                        element.appendChild(rippleContainer);
                    }
                    
                    // 只創建2層波紋（減少性能開銷）
                    for (let i = 0; i < 2; i++) {
                        const ripple = document.createElement('div');
                        ripple.className = 'ripple-wave';
                        const delay = i * 0.1;
                        const waveSize = size * (0.8 + i * 0.6);
                        const opacity = 0.8 - i * 0.3;
                        
                        ripple.style.cssText = `
                            width: ${waveSize}px;
                            height: ${waveSize}px;
                            left: ${x}px;
                            top: ${y}px;
                            animation: ${i === 1 ? 'ripple-effect-2' : 'ripple-effect'} ${0.6 + i * 0.2}s cubic-bezier(0.4, 0, 0.2, 1) ${delay}s both;
                            opacity: ${opacity};
                            transform: translate3d(-50%, -50%, 0);
                            will-change: transform, opacity;
                        `;
                        
                        rippleContainer.appendChild(ripple);
                        
                        // 移除波紋
                        setTimeout(() => {
                            if (ripple.parentNode) {
                                ripple.remove();
                            }
                        }, (0.6 + i * 0.2 + delay) * 1000 + 50);
                    }
                    
                    // 減少粒子數量（從16個減少到8個）
                    const particleCount = 8;
                    const particleColors = [
                        'rgba(255, 255, 255, 0.9)',
                        'rgba(96, 165, 250, 0.8)',
                        'rgba(167, 139, 250, 0.8)'
                    ];
                    
                    for (let i = 0; i < particleCount; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        const angle = (Math.PI * 2 / particleCount) * i;
                        const distance = size * 0.5;
                        const tx = Math.cos(angle) * distance;
                        const ty = Math.sin(angle) * distance;
                        const color = particleColors[i % particleColors.length];
                        
                        particle.style.cssText = `
                            left: ${x}px;
                            top: ${y}px;
                            width: 5px;
                            height: 5px;
                            --tx: ${tx}px;
                            --ty: ${ty}px;
                            animation: particle-float 0.6s cubic-bezier(0.4, 0, 0.2, 1) both;
                            background: ${color};
                            border-radius: 50%;
                            transform: translate3d(-50%, -50%, 0);
                            will-change: transform, opacity;
                        `;
                        
                        rippleContainer.appendChild(particle);
                        
                        // 移除粒子
                        setTimeout(() => {
                            if (particle.parentNode) {
                                particle.remove();
                            }
                        }, 600);
                    }
                    
                    // 簡化3D傾斜效果（使用transform3d強制GPU加速）
                    const originalTransform = element.style.transform;
                    const tiltX = ((x - rect.width / 2) / rect.width) * 2;
                    const tiltY = ((y - rect.height / 2) / rect.height) * 2;
                    element.style.transform = `${originalTransform || ''} translate3d(0, 0, 0) scale3d(0.98, 0.98, 1)`;
                    element.style.transition = 'transform 0.15s cubic-bezier(0.4, 0, 0.2, 1)';
                    
                    setTimeout(() => {
                        element.style.transform = originalTransform || '';
                        setTimeout(() => {
                            element.style.transition = '';
                        }, 150);
                    }, 150);
                    
                    // 移除動畫類和效果
                    setTimeout(() => {
                        element.classList.remove('click-effect');
                        element.dataset.animating = 'false';
                        
                        // 恢復原始樣式
                        if (needsPosition) {
                            element.style.position = '';
                        }
                        if (needsOverflow) {
                            element.style.overflow = '';
                        }
                    }, 400);
                });
            };

            useEffect(() => {
                // 檢測是否為桌面設備（支持hover和精確指針）
                const isDesktop = window.matchMedia('(hover: hover) and (pointer: fine)').matches;
                
                if (!isDesktop) {
                    // 手機設備，隱藏鼠標跟隨效果
                    const dot = document.getElementById('cursor-dot');
                    const outline = document.getElementById('cursor-outline');
                    if (dot) dot.style.display = 'none';
                    if (outline) outline.style.display = 'none';
                    return;
                }
                
                // 桌面設備，顯示並啟用鼠標跟隨效果
                const dot = document.getElementById('cursor-dot');
                const outline = document.getElementById('cursor-outline');
                if (!dot || !outline) return;
                
                dot.style.display = 'block';
                outline.style.display = 'block';
                
                const moveCursor = (e) => {
                    dot.style.left = `${e.clientX}px`;
                    dot.style.top = `${e.clientY}px`;
                    outline.animate({ left: `${e.clientX}px`, top: `${e.clientY}px` }, { duration: 500, fill: "forwards" });
                };
                
                window.addEventListener('mousemove', moveCursor);
                return () => window.removeEventListener('mousemove', moveCursor);
            }, []);

            const IMAGES = {
                google: "google project management.JPG",
                googleDataAnalytics: "google data analytics.JPG",
                cia: "CIA獨立公開英文演講.JPG",
                cia2: "cia演講2.jpg",
                tamkang: "淡江畢業證書.JPG",
                n8n: "n8n.JPG",
                finance: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?q=80&w=2511&auto=format&fit=crop",
                toeic: "多益JPG.JPG",
                cebu: "Cebu internantional academy畢業證書.jpg",
                trust: "信託業務專業.JPG",
                bankControl: "銀行內部控制與內部稽核.JPG",
                credit: "初階授信人員.JPG",
                // 證照官方icon
                iconGoogle: "google project management.JPG", // 如果Google有專門的icon文件，請替換此處
                iconTrust: "信託.jpg",
                iconBank: "銀行、授信.webp",
                iconToeic: "多益.webp",
                iconCia: "cia.jpg",
                iconThreads: "threads.png",
                profilePhoto: "IMG_7839.jpg"
            };

            const projects = [
                { 
                    id: 1, 
                    title: "Ledger", 
                    url: "https://david8015838-create.github.io/ledger-app/",
                    desc: "個人財務管理與信用卡分期追蹤",
                    demoData: {
                        // 預設預算
                        budget: {
                            total: 50000,
                            currentMonth: new Date().getMonth() + 1,
                            currentYear: new Date().getFullYear()
                        },
                        // 預設交易記錄（涵蓋各種情況）
                        transactions: [
                            // 現金交易
                            { id: 't1', date: '2024-01-05', amount: 150, currency: 'TWD', category: '飲食', note: '早餐 - 麥當勞', paymentMethod: 'cash' },
                            { id: 't2', date: '2024-01-05', amount: 80, currency: 'TWD', category: '交通', note: '捷運', paymentMethod: 'cash' },
                            { id: 't3', date: '2024-01-06', amount: 350, currency: 'TWD', category: '飲食', note: '午餐 - 日式料理', paymentMethod: 'cash' },
                            { id: 't4', date: '2024-01-07', amount: 1200, currency: 'TWD', category: '交通', note: '計程車費', paymentMethod: 'cash' },
                            { id: 't5', date: '2024-01-08', amount: 2500, currency: 'TWD', category: '購物', note: 'Uniqlo 衣服', paymentMethod: 'cash' },
                            { id: 't6', date: '2024-01-10', amount: 180, currency: 'TWD', category: '飲食', note: '星巴克咖啡', paymentMethod: 'cash' },
                            { id: 't7', date: '2024-01-12', amount: 800, currency: 'TWD', category: '娛樂', note: '電影票', paymentMethod: 'cash' },
                            { id: 't8', date: '2024-01-15', amount: 450, currency: 'TWD', category: '飲食', note: '晚餐 - 火鍋', paymentMethod: 'cash' },
                            { id: 't9', date: '2024-01-18', amount: 1200, currency: 'TWD', category: '醫療', note: '看診費', paymentMethod: 'cash' },
                            { id: 't10', date: '2024-01-20', amount: 3000, currency: 'TWD', category: '購物', note: '3C 產品', paymentMethod: 'cash' },
                            // 信用卡交易 - 無分期
                            { id: 't11', date: '2024-01-03', amount: 5000, currency: 'TWD', category: '購物', note: '網購 - 家電', paymentMethod: 'credit', creditCardId: 'cc1', installments: 1, interestRate: 0 },
                            { id: 't12', date: '2024-01-09', amount: 2800, currency: 'TWD', category: '娛樂', note: 'KTV 包廂', paymentMethod: 'credit', creditCardId: 'cc1', installments: 1, interestRate: 0 },
                            { id: 't13', date: '2024-01-14', amount: 1500, currency: 'TWD', category: '飲食', note: '高級餐廳', paymentMethod: 'credit', creditCardId: 'cc1', installments: 1, interestRate: 0 },
                            // 信用卡交易 - 有分期
                            { id: 't14', date: '2024-01-02', amount: 15000, currency: 'TWD', category: '購物', note: 'iPhone 15 Pro', paymentMethod: 'credit', creditCardId: 'cc1', installments: 12, interestRate: 6.5 },
                            { id: 't15', date: '2024-01-11', amount: 8000, currency: 'TWD', category: '購物', note: '筆電', paymentMethod: 'credit', creditCardId: 'cc1', installments: 6, interestRate: 5.5 },
                            { id: 't16', date: '2024-01-16', amount: 12000, currency: 'TWD', category: '購物', note: '家具', paymentMethod: 'credit', creditCardId: 'cc1', installments: 24, interestRate: 8.0 },
                            // 多幣種交易
                            { id: 't17', date: '2024-01-04', amount: 50, currency: 'USD', category: '購物', note: 'Amazon 購物', paymentMethod: 'credit', creditCardId: 'cc2', installments: 1, interestRate: 0 },
                            { id: 't18', date: '2024-01-13', amount: 100, currency: 'USD', category: '娛樂', note: 'Netflix 訂閱', paymentMethod: 'credit', creditCardId: 'cc2', installments: 1, interestRate: 0 },
                            { id: 't19', date: '2024-01-19', amount: 200, currency: 'JPY', category: '飲食', note: '日本餐廳', paymentMethod: 'cash' },
                            // 上個月的交易
                            { id: 't20', date: '2023-12-25', amount: 5000, currency: 'TWD', category: '購物', note: '聖誕禮物', paymentMethod: 'credit', creditCardId: 'cc1', installments: 3, interestRate: 4.5 },
                            { id: 't21', date: '2023-12-20', amount: 3000, currency: 'TWD', category: '娛樂', note: '跨年活動', paymentMethod: 'cash' },
                            { id: 't22', date: '2023-12-15', amount: 8000, currency: 'TWD', category: '購物', note: '年終購物', paymentMethod: 'credit', creditCardId: 'cc1', installments: 1, interestRate: 0 }
                        ],
                        // 預設信用卡
                        creditCards: [
                            {
                                id: 'cc1',
                                name: '花旗現金回饋卡',
                                dueDate: 15,
                                paymentInterval: 30,
                                initialBalance: 0,
                                repayments: [
                                    { date: '2023-12-15', amount: 12000 },
                                    { date: '2023-11-15', amount: 8500 }
                                ]
                            },
                            {
                                id: 'cc2',
                                name: '國泰世華卡',
                                dueDate: 25,
                                paymentInterval: 30,
                                initialBalance: 5000,
                                repayments: [
                                    { date: '2023-12-25', amount: 3000 },
                                    { date: '2023-11-25', amount: 2000 }
                                ]
                            }
                        ],
                        // 預設定期交易
                        recurringTransactions: [
                            {
                                id: 'r1',
                                name: 'Netflix 月費',
                                amount: 330,
                                currency: 'TWD',
                                category: '娛樂',
                                frequency: 'monthly',
                                startDate: '2024-01-01',
                                nextDate: '2024-02-01',
                                paymentMethod: 'credit',
                                creditCardId: 'cc1'
                            },
                            {
                                id: 'r2',
                                name: 'Spotify 月費',
                                amount: 149,
                                currency: 'TWD',
                                category: '娛樂',
                                frequency: 'monthly',
                                startDate: '2024-01-01',
                                nextDate: '2024-02-01',
                                paymentMethod: 'credit',
                                creditCardId: 'cc1'
                            },
                            {
                                id: 'r3',
                                name: '健身房月費',
                                amount: 1288,
                                currency: 'TWD',
                                category: '運動',
                                frequency: 'monthly',
                                startDate: '2024-01-01',
                                nextDate: '2024-02-01',
                                paymentMethod: 'credit',
                                creditCardId: 'cc1'
                            },
                            {
                                id: 'r4',
                                name: '手機費',
                                amount: 599,
                                currency: 'TWD',
                                category: '通訊',
                                frequency: 'monthly',
                                startDate: '2024-01-01',
                                nextDate: '2024-02-01',
                                paymentMethod: 'credit',
                                creditCardId: 'cc1'
                            },
                            {
                                id: 'r5',
                                name: '咖啡每日',
                                amount: 120,
                                currency: 'TWD',
                                category: '飲食',
                                frequency: 'daily',
                                startDate: '2024-01-01',
                                nextDate: '2024-01-02',
                                paymentMethod: 'cash'
                            }
                        ]
                    },
                    features: [
                        "預算顯示：當月剩餘、已花費、總預算即時視覺化",
                        "今日消費：顯示現金消費總額與筆數",
                        "信用卡待繳：分期＋結轉餘額含在本月帳單",
                        "新增交易：支援多幣種自動換算、分類、自訂備註",
                        "支付方式：現金即時入帳；信用卡可設定分期與年利率",
                        "分期計算：自動分配到各期，餘數落在最後一期",
                        "歷史記錄：月份切換、即時搜尋、日期分組展開、編輯刪除",
                        "統計分析：圓餅圖比例、分類明細、近6月趨勢圖",
                        "信用卡管理：結帳日、繳款間隔、初始餘額與還款記錄",
                        "定期交易：每日/週/月/年四種頻率，到期自動建立"
                    ]
                },
                { 
                    id: 2, 
                    title: "StockLens", 
                    url: "https://david8015838-create.github.io/stock-lens/",
                    desc: "投資資產追蹤與複利試算工具",
                    demoData: {
                        // 預設資產（涵蓋各種投資類型）
                        assets: [
                            // 股票
                            {
                                id: 'a1',
                                name: '台積電',
                                symbol: '2330',
                                type: 'stock',
                                shares: 50,
                                avgPrice: 550,
                                currentPrice: 580,
                                leverage: 1
                            },
                            {
                                id: 'a2',
                                name: '聯發科',
                                symbol: '2454',
                                type: 'stock',
                                shares: 20,
                                avgPrice: 800,
                                currentPrice: 850,
                                leverage: 1
                            },
                            {
                                id: 'a3',
                                name: '鴻海',
                                symbol: '2317',
                                type: 'stock',
                                shares: 100,
                                avgPrice: 105,
                                currentPrice: 110,
                                leverage: 1
                            },
                            {
                                id: 'a4',
                                name: '聯詠',
                                symbol: '3034',
                                type: 'stock',
                                shares: 30,
                                avgPrice: 450,
                                currentPrice: 480,
                                leverage: 1
                            },
                            {
                                id: 'a5',
                                name: '大立光',
                                symbol: '3008',
                                type: 'stock',
                                shares: 10,
                                avgPrice: 2200,
                                currentPrice: 2100,
                                leverage: 1
                            },
                            // ETF
                            {
                                id: 'a6',
                                name: '元大台灣50',
                                symbol: '0050',
                                type: 'etf',
                                shares: 100,
                                avgPrice: 120,
                                currentPrice: 125,
                                leverage: 1
                            },
                            {
                                id: 'a7',
                                name: '元大高股息',
                                symbol: '0056',
                                type: 'etf',
                                shares: 200,
                                avgPrice: 28,
                                currentPrice: 30,
                                leverage: 1
                            },
                            {
                                id: 'a8',
                                name: '富邦台50',
                                symbol: '006208',
                                type: 'etf',
                                shares: 80,
                                avgPrice: 85,
                                currentPrice: 88,
                                leverage: 1
                            },
                            // 債券
                            {
                                id: 'a9',
                                name: '美國10年期公債',
                                symbol: 'US10Y',
                                type: 'bond',
                                shares: 10,
                                avgPrice: 100,
                                currentPrice: 102,
                                leverage: 1,
                                couponRate: 4.5,
                                maturityDate: '2034-01-15'
                            },
                            {
                                id: 'a10',
                                name: '台灣10年期公債',
                                symbol: 'TW10Y',
                                type: 'bond',
                                shares: 20,
                                avgPrice: 100,
                                currentPrice: 101,
                                leverage: 1,
                                couponRate: 1.5,
                                maturityDate: '2034-06-30'
                            },
                            // 槓桿投資
                            {
                                id: 'a11',
                                name: '台積電 (槓桿)',
                                symbol: '2330',
                                type: 'stock',
                                shares: 20,
                                avgPrice: 550,
                                currentPrice: 580,
                                leverage: 2
                            },
                            {
                                id: 'a12',
                                name: '聯發科 (槓桿)',
                                symbol: '2454',
                                type: 'stock',
                                shares: 10,
                                avgPrice: 800,
                                currentPrice: 850,
                                leverage: 3
                            },
                            // 美股
                            {
                                id: 'a13',
                                name: 'Apple Inc.',
                                symbol: 'AAPL',
                                type: 'stock',
                                shares: 10,
                                avgPrice: 180,
                                currentPrice: 195,
                                leverage: 1
                            },
                            {
                                id: 'a14',
                                name: 'Microsoft Corp.',
                                symbol: 'MSFT',
                                type: 'stock',
                                shares: 5,
                                avgPrice: 350,
                                currentPrice: 380,
                                leverage: 1
                            },
                            {
                                id: 'a15',
                                name: 'NVIDIA Corp.',
                                symbol: 'NVDA',
                                type: 'stock',
                                shares: 8,
                                avgPrice: 450,
                                currentPrice: 520,
                                leverage: 1
                            },
                            {
                                id: 'a16',
                                name: 'Tesla Inc.',
                                symbol: 'TSLA',
                                type: 'stock',
                                shares: 15,
                                avgPrice: 250,
                                currentPrice: 240,
                                leverage: 1
                            }
                        ],
                        // 預設複利設定
                        compoundInterest: {
                            monthlyInvestment: 20000,
                            annualRate: 6,
                            startDate: '2024-01-01',
                            months: 12
                        }
                    },
                    features: [
                        "資產管理：支援股票、債券、ETF等多種投資標的，可設定股數、均價、槓桿倍數",
                        "即時追蹤：自動計算總市值、總成本、損益金額與損益百分比",
                        "複利試算：設定每月固定投入金額，系統自動計算複利效果，從第2個月開始計入本金",
                        "債券功能：支援債券類型資產，可設定票面利率與到期日",
                        "槓桿計算：支援槓桿投資，自動計算槓桿後的損益放大效果",
                        "數據視覺化：以直觀方式呈現各資產占比與整體投資組合表現",
                        "快速操作：一鍵新增、編輯、刪除資產，操作流程簡潔高效",
                        "本地儲存：所有數據儲存在本地，保護隱私且無需網路連線"
                    ]
                },
                { 
                    id: 3, 
                    title: "SplitWise Pro", 
                    url: "https://david8015838-create.github.io/splitwise-pro/",
                    desc: "多人分帳與雲端即時同步",
                    demoData: {
                        // 預設房間
                        roomId: 'demo-room-2024',
                        roomName: 'Demo 分帳群組',
                        // 預設成員
                        members: [
                            { id: 'm1', name: 'Owen', color: '#3B82F6' },
                            { id: 'm2', name: 'Alice', color: '#10B981' },
                            { id: 'm3', name: 'Bob', color: '#F59E0B' },
                            { id: 'm4', name: 'Charlie', color: '#EF4444' },
                            { id: 'm5', name: 'Diana', color: '#8B5CF6' }
                        ],
                        // 預設支出記錄（涵蓋各種分帳情況）
                        expenses: [
                            // 平均分攤
                            {
                                id: 'e1',
                                payer: 'm1',
                                amount: 1200,
                                description: '晚餐 - 火鍋',
                                date: '2024-01-15',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3'],
                                category: '飲食'
                            },
                            {
                                id: 'e2',
                                payer: 'm2',
                                amount: 800,
                                description: '電影票',
                                date: '2024-01-16',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3', 'm4'],
                                category: '娛樂'
                            },
                            // 按比例分攤
                            {
                                id: 'e3',
                                payer: 'm3',
                                amount: 5000,
                                description: 'Airbnb 住宿費',
                                date: '2024-01-10',
                                splitType: 'percentage',
                                participants: [
                                    { id: 'm1', percentage: 30 },
                                    { id: 'm2', percentage: 25 },
                                    { id: 'm3', percentage: 25 },
                                    { id: 'm4', percentage: 20 }
                                ],
                                category: '住宿'
                            },
                            // 自訂金額分攤
                            {
                                id: 'e4',
                                payer: 'm1',
                                amount: 3000,
                                description: '超市採買',
                                date: '2024-01-12',
                                splitType: 'custom',
                                participants: [
                                    { id: 'm1', amount: 1500 },
                                    { id: 'm2', amount: 800 },
                                    { id: 'm3', amount: 700 }
                                ],
                                category: '購物'
                            },
                            {
                                id: 'e5',
                                payer: 'm4',
                                amount: 1500,
                                description: '計程車費',
                                date: '2024-01-17',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3', 'm4'],
                                category: '交通'
                            },
                            {
                                id: 'e6',
                                payer: 'm2',
                                amount: 2000,
                                description: 'KTV 包廂',
                                date: '2024-01-18',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3', 'm4', 'm5'],
                                category: '娛樂'
                            },
                            {
                                id: 'e7',
                                payer: 'm5',
                                amount: 600,
                                description: '飲料',
                                date: '2024-01-19',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3', 'm4', 'm5'],
                                category: '飲食'
                            },
                            {
                                id: 'e8',
                                payer: 'm1',
                                amount: 4500,
                                description: '高級餐廳',
                                date: '2024-01-20',
                                splitType: 'percentage',
                                participants: [
                                    { id: 'm1', percentage: 40 },
                                    { id: 'm2', percentage: 30 },
                                    { id: 'm3', percentage: 30 }
                                ],
                                category: '飲食'
                            },
                            {
                                id: 'e9',
                                payer: 'm3',
                                amount: 2500,
                                description: '門票',
                                date: '2024-01-14',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3'],
                                category: '娛樂'
                            },
                            {
                                id: 'e10',
                                payer: 'm4',
                                amount: 1800,
                                description: '停車費',
                                date: '2024-01-21',
                                splitType: 'custom',
                                participants: [
                                    { id: 'm1', amount: 600 },
                                    { id: 'm2', amount: 600 },
                                    { id: 'm3', amount: 600 }
                                ],
                                category: '交通'
                            },
                            // 更多複雜情況
                            {
                                id: 'e11',
                                payer: 'm1',
                                amount: 8000,
                                description: '租車費用',
                                date: '2024-01-08',
                                splitType: 'custom',
                                participants: [
                                    { id: 'm1', amount: 3000 },
                                    { id: 'm2', amount: 2000 },
                                    { id: 'm3', amount: 1500 },
                                    { id: 'm4', amount: 1500 }
                                ],
                                category: '交通'
                            },
                            {
                                id: 'e12',
                                payer: 'm2',
                                amount: 3500,
                                description: '紀念品',
                                date: '2024-01-22',
                                splitType: 'equal',
                                participants: ['m1', 'm2', 'm3', 'm4', 'm5'],
                                category: '購物'
                            }
                        ],
                        // 預設結算記錄
                        settlements: [
                            {
                                id: 's1',
                                from: 'm2',
                                to: 'm1',
                                amount: 450,
                                date: '2024-01-16',
                                description: '結算部分帳務'
                            },
                            {
                                id: 's2',
                                from: 'm3',
                                to: 'm1',
                                amount: 300,
                                date: '2024-01-18',
                                description: '結算部分帳務'
                            }
                        ]
                    },
                    features: [
                        "雲端同步：輸入房間號碼即可建立共享空間，所有成員即時看到最新帳務狀態",
                        "多人分帳：支援任意人數的群組分帳，可設定不同成員的分攤比例",
                        "多種分帳模式：平均分攤、按比例分攤、自訂金額分攤，滿足各種情境需求",
                        "帳務記錄：詳細記錄每筆支出的發起人、參與人、金額與備註",
                        "結算功能：自動計算每位成員應付/應收金額，清楚顯示誰欠誰多少錢",
                        "即時更新：任何成員新增或修改帳務，其他成員立即看到更新，無需手動刷新",
                        "歷史查詢：保留完整的分帳歷史記錄，可隨時查看過往帳務明細",
                        "簡潔介面：直觀的操作介面，快速上手，適合日常使用"
                    ]
                },
                { 
                    id: 4, 
                    title: "SurveyLight", 
                    url: "https://david8015838-create.github.io/SurveyLight/",
                    desc: "極致輕量與高效互動的問卷調查平台",
                    demoData: {
                        surveys: [
                            { id: 's1', title: '使用者滿意度調查', responses: 45, status: 'active' },
                            { id: 's2', title: '活動報名表', responses: 120, status: 'closed' }
                        ]
                    },
                    features: [
                        "全能儀表板：一站式監控問卷狀態，支援數據分析、模擬預覽與副本複製",
                        "智能編輯器：支援簡答、單/多選、線性分級及檔案上傳，可設定截止時間與人數上限",
                        "沈浸模式 (Focus Mode)：提供簡約深色介面，搭配動態進度條與平滑翻頁，提升填答率",
                        "即時反饋：內建必填檢查，填答完成觸發 Canvas Confetti 彩帶特效",
                        "戰情室模式 (War Room)：黑客風格視覺化數據分析，適合大螢幕實時監控",
                        "實時數據同步：基於 Firebase Firestore 技術，無需整理頁面即可看到最新回覆",
                        "PWA 支援：可安裝至手機或桌面，提供類原生應用的使用體驗",
                        "響應式設計：採用 Tailwind CSS 構建，完美適配行動裝置、平板與桌機"
                    ]
                },
                { 
                    id: 5, 
                    title: "Nexus Mind", 
                    url: "https://david8015838-create.github.io/nexus-mind/",
                    desc: "深度社交個人關係管理系統 (PRM)",
                    demoData: {
                        memories: [
                            { id: 'm1', content: '與團隊討論新功能開發', date: '2024-01-20' },
                            { id: 'm2', content: '記錄關於 AI 發展的個人見解', date: '2024-01-22' }
                        ]
                    },
                    features: [
                        "社交情報鏈：時間軸管理聯絡動態，具備智慧行程提醒與社交冷卻機制",
                        "關係圖譜視覺化：使用力導向圖技術將人際網絡視覺化，支援自定義分類過濾",
                        "聯覺搜尋：多維度檢索姓名、公司、標籤或記憶碎片，並標註匹配原因",
                        "智慧名片辨識：整合 Tesseract.js OCR 技術，精準識別中英文混合名片資訊",
                        "個人數位名片：快速產生專屬 QR Code 與美觀的公開展示頁面",
                        "雲端同步：Firebase 整合確保多設備即時同步，並具備本地優先儲存設計",
                        "現代化 UI：基於 Tailwind CSS 的磨砂玻璃質感 (Glassmorphism) 與動態漸層",
                        "流暢體驗：React 狀態管理搭配 Framer Motion 動畫，提供類原生 App 手感"
                    ]
                }
            ];

            const experiences = [
                { id: "tamkang", title: "Tamkang University", subtitle: "Department of International Business, Bachelor of International Business", tag: "Education", summary: "深研國際市場分析與商業策略思維。", details: "在淡江大學期間，專注於國際市場趨勢分析、跨國企業策略規劃以及數據導向的商業邏輯。", image: IMAGES.tamkang, images: [IMAGES.tamkang] },
                { id: "cia", title: "Cebu International Academy", subtitle: "ESL, Business English - 獨立公開英文演講", tag: "Public Speaking", summary: "於菲律賓期間完成獨立公開專題演講。", details: "修習 ESL 與 Business English 課程，並挑戰完成了一場面向大眾的獨立英文演講，磨練了高壓下的表達力。", image: IMAGES.cia, images: [IMAGES.cia, IMAGES.cia2] },
                { id: "google", title: "Google Career Certificate", subtitle: "Project Management & Data Analytics", tag: "Professional", summary: "取得 Google 官方 Project Management 與 Data Analytics 認證。", details: "掌握敏捷開發 (Agile) 與 Scrum 框架，以及數據分析與視覺化技能。", image: IMAGES.google, images: [IMAGES.google, IMAGES.googleDataAnalytics] },
                { id: "n8n", title: "n8n Automation", subtitle: "Workflow Architect", tag: "Technical Skill", summary: "簡化工作流、提高效率的解決方案。", details: "1.自動搜集：每天早上 7 點，它會跑去你指定的 5 個 AI 網站抓最新消息。\n\n2.挑選重點：它會過濾掉舊聞，只挑出當天最熱門的 10 則新聞。\n\n3.AI 分析：把這些新聞交給 Gemini AI 幫你寫成「產業分析」和「商務英文筆記」。\n\n4.發送到家：最後自動寄出兩封 Gmail 到你信箱，讓你不用點開網頁，喝咖啡時就能讀完今日科技精華。", image: IMAGES.n8n, images: [IMAGES.n8n] }
            ];

            const certificateGroups = [
                { category: "GOOGLE 專業證照", items: [
                    { id: "goo-1", title: "Project Management", issuer: "Google", image: IMAGES.google, desc: "專案規劃與風險管理。", icon: "google" },
                    { id: "goo-2", title: "Data Analytics", issuer: "Google", image: IMAGES.googleDataAnalytics, desc: "數據分析與視覺化實務。", icon: "google" }
                ]},
                { category: "金融專業資格", items: [
                    { id: "fin-3", title: "信託業務專業", issuer: "信託業商業同業公會", image: IMAGES.trust, desc: "信託業務實務與法規。", icon: "trust" },
                    { id: "fin-4", title: "銀行內部控制與內部稽核", issuer: "銀行公會", image: IMAGES.bankControl, desc: "銀行內控制度與稽核實務。", icon: "bank" },
                    { id: "fin-5", title: "初階授信人員", issuer: "銀行公會", image: IMAGES.credit, desc: "授信業務基礎實務。", icon: "bank" }
                ]},
                { category: "國際語言能力", items: [
                    { id: "lang-1", title: "TOEIC 多益英語測驗", issuer: "ETS", image: IMAGES.toeic, desc: "870(gold)", badge: "gold", icon: "ets" },
                    { id: "lang-2", title: "Cebu International Academy", issuer: "CIA", image: IMAGES.cebu, desc: "菲律賓語言學校畢業證書。", needsRotation: true, icon: "cia" }
                ]}
            ];

            // 合併所有證照到一個數組
            const allCertificates = certificateGroups.flatMap(group => 
                group.items.map(cert => ({ ...cert, category: group.category }))
            );

            const { scrollYProgress } = useScroll();
            const springProgress = useSpring(scrollYProgress, { stiffness: 100, damping: 30 });

            return (
                <div className="relative">
                    
                    {/* Simpsons Intro Overlay */}
                    {waitingStart && (
                        <div id="simpson-overlay" className="fixed inset-0 z-[150] flex items-center justify-center bg-black">
                            <iframe id="simpson-iframe" src="辛普森動畫index.html" className="absolute inset-0 w-full h-full border-0"></iframe>
                        </div>
                    )}

                    <canvas id="static-overlay" className="fixed inset-0 z-[250] opacity-0 pointer-events-none"></canvas>

                    {/* Typewriter Overlay - 全黑屏幕和打字機效果 */}
                    {showTypewriter && (
                        <div id="typewriter-overlay" className="fixed inset-0 z-[300] bg-black flex items-center justify-center">
                            <div className="text-center px-4 max-w-4xl">
                                <div className="text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-light text-white mb-4 md:mb-6 tracking-wider">
                                    <div className="min-h-[3rem] md:min-h-[4rem] lg:min-h-[5rem] flex items-center justify-center">
                                        {typewriterText1}
                                        {(typewriterText1.length < 'HI! MY NAME IS OWEN'.length || (typewriterText1.length === 'HI! MY NAME IS OWEN'.length && typewriterText2.length === 0)) && (
                                            <span className="inline-block w-0.5 h-[1em] bg-white ml-2 animate-pulse" style={{ animation: 'blink 1s infinite' }}></span>
                                        )}
                                    </div>
                                </div>
                                <div className="text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-light text-white tracking-wider">
                                    <div className="min-h-[3rem] md:min-h-[4rem] lg:min-h-[5rem] flex items-center justify-center">
                                        {typewriterText2}
                                        {typewriterText1.length === 'HI! MY NAME IS OWEN'.length && typewriterText2.length < 'WELCOME TO MY PORTFOLIO'.length && (
                                            <span className="inline-block w-0.5 h-[1em] bg-white ml-2 animate-pulse" style={{ animation: 'blink 1s infinite' }}></span>
                                        )}
                                    </div>
                                </div>
                            </div>
                            <style>{`
                                @keyframes gradient-slide {
                                    0% {
                                        background-position: 0% 50%;
                                    }
                                    50% {
                                        background-position: 100% 50%;
                                    }
                                    100% {
                                        background-position: 0% 50%;
                                    }
                                }
                                @keyframes blink {
                                    0%, 50% { opacity: 1; }
                                    51%, 100% { opacity: 0; }
                                }
                            `}</style>
                        </div>
                    )}

                    {/* Stage: Web Content */}
                    <div id="web-content" className={`relative z-10 ${stage === 'web' ? 'opacity-100 visible' : 'opacity-0 invisible'}`} style={{ display: stage === 'web' ? 'block' : 'none' }}>
                        {/* 背景層 */}
                        <div className="fixed inset-0 z-0 pointer-events-none">
                            <div className="absolute inset-0 bg-noise" />
                            <div className="absolute top-[5%] left-[5%] w-[50vw] h-[50vw] bg-blue-500/5 rounded-full blur-[140px]" />
                            <div className="absolute top-[60%] right-[10%] w-[40vw] h-[40vw] bg-purple-500/3 rounded-full blur-[120px]" />
                            <div className="absolute bottom-[10%] left-[20%] w-[30vw] h-[30vw] bg-cyan-500/4 rounded-full blur-[100px]" />
                            {/* 裝飾性線條 */}
                            <div className="absolute top-1/4 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent" />
                            <div className="absolute top-1/2 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/3 to-transparent" />
                            <div className="absolute top-3/4 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent" />
                            {/* 裝飾性點 */}
                        </div>

                        <motion.div className="fixed top-0 left-0 right-0 h-0.5 bg-white z-[60] origin-left" style={{ scaleX: springProgress }} />

                        <nav className="fixed top-0 w-full z-50">
                            <div className="max-w-7xl mx-auto px-3 sm:px-4 md:px-8 h-[5rem] md:h-20 flex items-end justify-between border-b border-white/5 backdrop-blur-md pb-3 md:pb-0">
                                <div className="flex items-center gap-1.5 sm:gap-2 md:gap-3 font-medium tracking-tighter text-sm sm:text-base md:text-lg uppercase flex-shrink-0">
                                    <div className="w-1.5 h-1.5 sm:w-1.5 sm:h-1.5 bg-white rounded-full animate-pulse" />
                                    <span 
                                        className="hidden sm:inline portfolio-metal"
                                        data-text="Studio Portfolio"
                                    >
                                        Studio Portfolio
                                    </span>
                                    <span 
                                        className="sm:hidden text-xs portfolio-metal"
                                        data-text="Portfolio"
                                    >
                                        Portfolio
                                    </span>
                                </div>
                                <div className="flex items-center gap-2 sm:gap-3 md:gap-8 text-[9px] sm:text-[9px] md:text-[10px] tracking-[0.15em] sm:tracking-[0.2em] font-medium uppercase flex-shrink-0">
                                    <a 
                                        href="#projects" 
                                        onClick={handleClickEffect} 
                                        className="md:inline whitespace-nowrap cursor-pointer active:scale-95 transition-transform text-transparent bg-clip-text hover:opacity-100"
                                        style={{
                                            backgroundImage: 'linear-gradient(90deg, #a3a3a3 0%, #ffffff 33%, #e8e8e8 66%, #a3a3a3 100%)',
                                            backgroundSize: '200% 100%',
                                            animation: 'gradient-slide 5s ease infinite',
                                            WebkitBackgroundClip: 'text',
                                            WebkitTextFillColor: 'transparent',
                                            opacity: 0.85,
                                            filter: 'drop-shadow(0 1px 1px rgba(255, 255, 255, 0.2))'
                                        }}
                                        onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}
                                        onMouseLeave={(e) => e.currentTarget.style.opacity = '0.85'}
                                    >
                                        Projects
                                    </a>
                                    <a 
                                        href="#journey" 
                                        onClick={handleClickEffect} 
                                        className="md:inline whitespace-nowrap cursor-pointer active:scale-95 transition-transform text-transparent bg-clip-text hover:opacity-100"
                                        style={{
                                            backgroundImage: 'linear-gradient(90deg, #a3a3a3 0%, #ffffff 33%, #e8e8e8 66%, #a3a3a3 100%)',
                                            backgroundSize: '200% 100%',
                                            animation: 'gradient-slide 5.5s ease infinite',
                                            WebkitBackgroundClip: 'text',
                                            WebkitTextFillColor: 'transparent',
                                            opacity: 0.85,
                                            filter: 'drop-shadow(0 1px 1px rgba(255, 255, 255, 0.2))'
                                        }}
                                        onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}
                                        onMouseLeave={(e) => e.currentTarget.style.opacity = '0.85'}
                                    >
                                        Journey
                                    </a>
                                    <a 
                                        href="#certs" 
                                        onClick={handleClickEffect} 
                                        className="md:inline whitespace-nowrap cursor-pointer active:scale-95 transition-transform text-transparent bg-clip-text hover:opacity-100"
                                        style={{
                                            backgroundImage: 'linear-gradient(90deg, #a3a3a3 0%, #ffffff 33%, #e8e8e8 66%, #a3a3a3 100%)',
                                            backgroundSize: '200% 100%',
                                            animation: 'gradient-slide 6s ease infinite',
                                            WebkitBackgroundClip: 'text',
                                            WebkitTextFillColor: 'transparent',
                                            opacity: 0.85,
                                            filter: 'drop-shadow(0 1px 1px rgba(255, 255, 255, 0.2))'
                                        }}
                                        onMouseEnter={(e) => e.currentTarget.style.opacity = '1'}
                                        onMouseLeave={(e) => e.currentTarget.style.opacity = '0.85'}
                                    >
                                        Certs
                                    </a>
                                    <a 
                                        href="mailto:david8015838@gmail.com" 
                                        onClick={handleClickEffect} 
                                        className="border border-white/20 px-3 sm:px-4 md:px-6 py-1 sm:py-1.5 md:py-2 rounded-full bg-white/5 text-[9px] sm:text-[9px] md:text-[10px] whitespace-nowrap cursor-pointer active:scale-95 transition-transform backdrop-blur-sm relative overflow-hidden group"
                                        style={{
                                            position: 'relative'
                                        }}
                                    >
                                        <span 
                                            className="text-transparent bg-clip-text relative z-10"
                                            style={{
                                                backgroundImage: 'linear-gradient(90deg, #ffffff 0%, #d4d4d4 33%, #ffffff 66%, #d4d4d4 100%)',
                                                backgroundSize: '200% 100%',
                                                animation: 'gradient-slide 4s ease infinite',
                                                WebkitBackgroundClip: 'text',
                                                WebkitTextFillColor: 'transparent',
                                                filter: 'drop-shadow(0 1px 2px rgba(255, 255, 255, 0.3))'
                                            }}
                                        >
                                            Connect
                                        </span>
                                        {/* 悬停时的金属光泽背景光效 */}
                                        <div 
                                            className="absolute inset-0 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"
                                            style={{
                                                background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(192, 192, 192, 0.15) 50%, rgba(255, 255, 255, 0.1) 100%)',
                                                backdropFilter: 'blur(10px)',
                                                WebkitBackdropFilter: 'blur(10px)',
                                                boxShadow: 'inset 0 1px 3px rgba(255, 255, 255, 0.3)'
                                            }}
                                        />
                                    </a>
                                </div>
                            </div>
                        </nav>

                        <main className="max-w-7xl mx-auto px-4 md:px-8">
                            <section className="min-h-[70vh] flex flex-col justify-center pb-32 md:pb-40 pt-20 md:pt-24 relative" style={{ overflow: 'visible' }}>
                                {/* 水平渐层背景 - 只在水平方向延伸 */}
                                <div className="absolute pointer-events-none z-0 hidden md:block" style={{
                                    left: '0',
                                    right: '0',
                                    top: '4rem',
                                    height: '55%',
                                    background: 'linear-gradient(to right, transparent 0%, rgba(255,255,255,0.005) 30%, rgba(255,255,255,0.008) 50%, rgba(255,255,255,0.01) 70%, rgba(255,255,255,0.012) 85%, transparent 100%)',
                                    filter: 'blur(40px)'
                                }}></div>
                                
                                {/* 照片 - 融入主題設計 */}
                                <div className="absolute opacity-70 hover:opacity-85 transition-opacity duration-300 z-0 flex flex-col items-center md:w-[70%] w-[50%] md:h-[50%] h-[35%] md:top-[4rem] top-[5rem] md:right-[-8%] right-[-5%] pointer-events-none">
                                    <div className="relative w-full h-full mb-2" style={{
                                        maskImage: 'radial-gradient(ellipse 90% 90% at 50% 50%, black 40%, rgba(0,0,0,0.8) 50%, rgba(0,0,0,0.4) 60%, rgba(0,0,0,0.2) 70%, transparent 85%)',
                                        WebkitMaskImage: 'radial-gradient(ellipse 90% 90% at 50% 50%, black 40%, rgba(0,0,0,0.8) 50%, rgba(0,0,0,0.4) 60%, rgba(0,0,0,0.2) 70%, transparent 85%)',
                                        maskSize: '100% 100%',
                                        WebkitMaskSize: '100% 100%',
                                        maskRepeat: 'no-repeat',
                                        WebkitMaskRepeat: 'no-repeat'
                                    }}>
                                        <div className="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent blur-xl"></div>
                                        <img 
                                            src={IMAGES.profilePhoto} 
                                            alt="Profile" 
                                            className={`relative w-full h-full object-contain shadow-[0_8px_32px_rgba(0,0,0,0.3)] grayscale hover:grayscale-0 transition-all duration-700 ${imagesLoaded ? 'opacity-70' : 'opacity-0'}`} 
                                            style={{
                                                filter: 'brightness(1.0) contrast(1.2)'
                                            }}
                                        />
                                    </div>
                                    <div className="text-center pointer-events-auto mt-2" style={{ 
                                        position: 'relative', 
                                        width: '100%',
                                        maxWidth: '100%',
                                        boxSizing: 'border-box',
                                        zIndex: 10
                                    }}>
                                        <p className="text-zinc-400 text-[9px] md:text-xs font-light tracking-wider whitespace-nowrap inline-block" style={{
                                            maxWidth: '100%',
                                            transform: 'translateX(0)'
                                        }}>
                                            <span>陳宥緯</span> <span className="text-zinc-600 mx-0.5 md:mx-1">|</span> <span className="text-zinc-500 uppercase">OWEN</span>
                                        </p>
                                    </div>
                                </div>
                                
                                <div className="relative z-20 md:mt-0 mt-8 md:pt-8 pt-4">
                                    <p className="font-mono mb-4 md:mb-8 tracking-[0.4em] uppercase whitespace-nowrap md:max-w-[10vw] md:w-fit text-zinc-500" style={{ 
                                        fontSize: 'clamp(8px, 1vw, 12px)',
                                        width: '5vw',
                                        maxWidth: '5vw',
                                        position: 'relative',
                                        zIndex: 20
                                    }}>
                                        Vibe Coder / Forward-Thinking
                                    </p>
                                <h1 className="text-[10vw] md:text-[8vw] font-light tracking-tighter leading-[0.8] mb-4 md:mb-6">
                                        <span className="inline-block text-white">MAKING</span> <br />
                                        <span className="font-serif italic font-normal text-zinc-500 text-[11vw] md:text-[9vw] inline-block" style={{ marginLeft: '0.28em', marginTop: '-0.08em' }}>Impact.</span>
                                </h1>
                                    <div className="flex items-center gap-4 md:gap-8">
                                        <div className="h-px w-12 md:w-20 bg-zinc-700" />
                                        <p className="max-w-md text-zinc-500 text-xs md:text-sm leading-relaxed">跨越數據分析與流程自動化，將深層邏輯重塑為推動專案成功的實質影響。</p>
                                    </div>
                                </div>
                                
                                {/* Project Matrix - 移動到照片位置（右側，MAKING Impact.下方） */}
                                <div 
                                    onClick={(e) => {
                                        handleClickEffect(e);
                                        setActiveProjectModal(true);
                                    }} 
                                    className="group absolute cursor-pointer border border-white/20 rounded-[2.5rem] overflow-hidden bg-gradient-to-br from-white/[0.03] to-white/[0.01] hover:from-white/[0.05] hover:to-white/[0.02] transition-all duration-700 backdrop-blur-lg active:scale-[0.98] z-10 md:w-[65%] w-[85%] md:top-auto md:bottom-[-5rem] bottom-[-3rem] md:right-[-8%] right-[5%] project-matrix-float"
                                    style={{
                                        isolation: 'isolate',
                                        background: 'linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.015) 50%, rgba(255,255,255,0.025) 100%)',
                                        transformStyle: 'preserve-3d',
                                        perspective: '1000px',
                                        transition: 'box-shadow 0.7s cubic-bezier(0.4, 0, 0.2, 1), background 0.7s cubic-bezier(0.4, 0, 0.2, 1)'
                                    }}
                                    onMouseEnter={(e) => {
                                        e.currentTarget.style.animationPlayState = 'paused';
                                        e.currentTarget.style.transform = 'translateY(-20px) translateZ(30px) scale(1.03)';
                                        e.currentTarget.style.boxShadow = 'inset 0 1px 3px 0 rgba(255,255,255,0.2), 0 25px 70px 0 rgba(0,0,0,0.7), 0 10px 35px 0 rgba(255,255,255,0.1), 0 0 60px 0 rgba(255,255,255,0.15)';
                                    }}
                                    onMouseLeave={(e) => {
                                        e.currentTarget.style.animationPlayState = 'running';
                                        e.currentTarget.style.transform = '';
                                        e.currentTarget.style.boxShadow = '';
                                    }}
                                >
                                    {/* 玻璃質感的反射光線 */}
                                    <div className="absolute inset-0 bg-gradient-to-br from-white/[0.04] via-transparent to-transparent opacity-25 group-hover:opacity-40 transition-opacity duration-700 pointer-events-none"></div>
                                    <div className="absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/[0.03] to-transparent opacity-20 group-hover:opacity-35 transition-opacity duration-700 pointer-events-none"></div>
                                    
                                    {/* 背景光暈效果 */}
                                    <div className="absolute inset-0 bg-gradient-to-r from-white/0 via-gray-300/3 to-gray-200/0 opacity-15 group-hover:opacity-30 transition-opacity duration-700"></div>
                                    
                                    
                                    {/* 玻璃質感邊框光效 - 增強浮起感 */}
                                    <div className="absolute inset-0 rounded-[2.5rem] border-2 border-white/20 group-hover:border-white/40 transition-all duration-700" style={{
                                        boxShadow: 'inset 0 2px 4px 0 rgba(255,255,255,0.15), inset 0 -1px 2px 0 rgba(255,255,255,0.1), 0 0 30px 0 rgba(255,255,255,0.06)'
                                    }}></div>
                                    {/* 外層光暈 - 增強浮起感 */}
                                    <div className="absolute -inset-[2px] rounded-[2.5rem] bg-gradient-to-r from-white/0 via-gray-400/20 to-gray-300/0 opacity-30 group-hover:opacity-60 blur-2xl transition-opacity duration-700 -z-10"></div>
                                    {/* 底部高光 - 增強玻璃浮起感 */}
                                    <div className="absolute bottom-0 left-0 right-0 h-1/3 bg-gradient-to-t from-white/[0.03] to-transparent rounded-b-[2.5rem] opacity-25 group-hover:opacity-50 transition-opacity duration-700 pointer-events-none"></div>
                                    
                                    <div className="py-12 px-6 flex flex-col items-center text-center relative z-10">
                                        {/* 標題 - 漸變滑動效果 */}
                                        <h2 
                                            className="text-3xl md:text-4xl font-light tracking-tighter mb-3 text-transparent bg-clip-text"
                                            style={{
                                                backgroundImage: 'linear-gradient(90deg, #ffffff 0%, #e8e8e8 25%, #c0c0c0 50%, #e8e8e8 75%, #ffffff 100%)',
                                                backgroundSize: '200% 100%',
                                                animation: 'gradient-slide 3s ease infinite',
                                                WebkitBackgroundClip: 'text',
                                                WebkitTextFillColor: 'transparent'
                                            }}
                                        >
                                            Project Matrix
                                        </h2>
                                        
                                        {/* 副標題 - 更精緻 */}
                                        <div className="flex items-center gap-2 mb-2">
                                            <div className="h-px w-6 bg-gradient-to-r from-transparent to-zinc-500 group-hover:to-zinc-300 transition-colors duration-500"></div>
                                            <p 
                                                className="text-[9px] uppercase tracking-[0.6em] font-medium text-transparent bg-clip-text"
                                                style={{
                                                    backgroundImage: 'linear-gradient(90deg, #a1a1aa 0%, #d4d4d4 50%, #e8e8e8 100%)',
                                                    backgroundSize: '200% 100%',
                                                    animation: 'gradient-slide 4s ease infinite',
                                                    WebkitBackgroundClip: 'text',
                                                    WebkitTextFillColor: 'transparent'
                                                }}
                                            >
                                                Explore Artifacts
                                            </p>
                                            <div className="h-px w-6 bg-gradient-to-l from-transparent to-zinc-500 group-hover:to-zinc-300 transition-colors duration-500"></div>
                                        </div>
                                        
                                        {/* 提示文字 - 默認顯示，更明顯 */}
                                        <div className="flex items-center gap-2 mt-2 opacity-70 group-hover:opacity-100 transition-opacity duration-500">
                                            <p className="text-zinc-400 text-[10px] uppercase tracking-wider">
                                            Click to discover
                                        </p>
                                            <svg className="w-2.5 h-2.5 text-zinc-400 group-hover:text-white group-hover:translate-x-1 transition-all duration-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                            </svg>
                                        </div>
                                    </div>
                                    
                                    {/* 角落裝飾 */}
                                </div>
                            </section>

                            <section id="journey" ref={journeySectionRef} className="mb-8 relative overflow-visible mt-[8rem] md:mt-[12rem]">
                                <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"></div>
                                
                                {/* 聚光燈效果 */}
                                {journeySectionInView && (
                                    <div className="spotlight-effect">
                                        <div className="spotlight-beam"></div>
                                        <div className="spotlight-glow"></div>
                                    </div>
                                )}
                                
                                <div className="grid grid-cols-1 lg:grid-cols-12 gap-12 border-t border-white/5 pt-8 relative mt-8">
                                    <div className="lg:col-span-4 lg:sticky lg:top-32 h-fit z-10">
                                        <h3 className="text-xs font-bold tracking-[0.6em] text-zinc-600 uppercase mb-6">Selected Journey</h3>
                                        <p ref={journeyDescriptionRef} className="text-xl font-light text-zinc-400 leading-tight min-h-[1.5em]">
                                            {journeyDescription}
                                            {journeyDescription.length < "Connecting the dots of experience to foster a vision that stops learning.".length && (
                                                <span className="animate-pulse ml-1 text-zinc-400">|</span>
                                            )}
                                        </p>
                                    </div>
                                    <div className="lg:col-span-8 space-y-1 relative pl-8 md:pl-0">
                                        {/* 時間軸 - 垂直線（桌面版） */}
                                        <div className="absolute left-0 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent hidden md:block" style={{
                                            left: '20px'
                                        }}></div>
                                        
                                        {/* 時間軸 - 垂直線（手機版） */}
                                        <div className="absolute left-4 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-white/10 to-transparent md:hidden"></div>
                                        
                                        {experiences.map((exp, index) => {
                                            const expRef = useRef(null);
                                            const isInView = useInView(expRef, { once: false, amount: 0.2 });
                                            const isLast = index === experiences.length - 1;
                                            return (
                                                <motion.div
                                                    key={exp.id}
                                                    ref={expRef}
                                                    initial={{ 
                                                        opacity: 0, 
                                                        y: 50,
                                                        x: 30,
                                                        filter: 'brightness(0.5)'
                                                    }}
                                                    animate={isInView ? { 
                                                        opacity: 1, 
                                                        y: 0,
                                                        x: 0,
                                                        filter: 'brightness(1)'
                                                    } : { 
                                                        opacity: 0, 
                                                        y: 50,
                                                        x: 30,
                                                        filter: 'brightness(0.5)'
                                                    }}
                                                    transition={{ 
                                                        duration: 0.3, 
                                                        ease: [0.25, 0.1, 0.25, 1]
                                                    }}
                                                    className="group relative py-4 md:py-6 transition-all duration-500 md:pl-12 cursor-pointer active:opacity-80 active:scale-[0.98]"
                                                    onClick={(e) => {
                                                        handleClickEffect(e);
                                                        setActiveExpModal(exp);
                                                    }}
                                                >
                                                    {/* 聚光燈效果 */}
                                                    <div className={`experience-spotlight ${isInView ? 'active' : ''}`}></div>
                                                    
                                                    {/* 內容區域 */}
                                                    <motion.div 
                                                        className="relative"
                                                        initial={{ opacity: 0 }}
                                                        animate={isInView ? { opacity: 1 } : { opacity: 0 }}
                                                        transition={{ duration: 0.3 }}
                                                    >
                                                <div className="flex flex-col md:flex-row items-start gap-6">
                                                            <div 
                                                                className="space-y-4 flex-1 cursor-pointer group/exp relative active:scale-[0.98]"
                                                                onClick={(e) => {
                                                                    handleClickEffect(e);
                                                                    setActiveExpModal(exp);
                                                                }}
                                                            >
                                                                {/* 点击提示箭头 - 始终显示，hover时更明显 */}
                                                                <div className="absolute top-0 right-0 opacity-40 group-hover/exp:opacity-100 transition-all duration-500 group-hover/exp:translate-x-1 -translate-x-1 relative z-10">
                                                                    <svg 
                                                                        className={`w-5 h-5 text-white transition-colors duration-500 relative z-10 ${journeySectionInView ? 'arrow-glow-active' : ''}`}
                                                                        fill="none" 
                                                                        stroke="currentColor" 
                                                                        viewBox="0 0 24 24"
                                                                        style={{
                                                                            color: '#ffffff'
                                                                        }}
                                                                    >
                                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                                    </svg>
                                                                </div>
                                                                <motion.span 
                                                                    className="text-[10px] font-bold tracking-widest text-zinc-500 uppercase px-2 py-1 border border-zinc-800 rounded inline-block"
                                                                    initial={{ opacity: 0, scale: 0.8 }}
                                                                    animate={isInView ? { opacity: 1, scale: 1 } : { opacity: 0, scale: 0.8 }}
                                                                    transition={{ duration: 0.3 }}
                                                                >
                                                                    {exp.tag}
                                                                </motion.span>
                                                                <motion.h4 
                                                                    className="text-3xl font-light group-hover/exp:translate-x-2 transition-all duration-300 text-white pr-8 hover:scale-110 hover:font-semibold"
                                                                    initial={{ opacity: 0, x: -20, scale: 1 }}
                                                                    animate={isInView ? { opacity: 1, x: 0, scale: 1.1 } : { opacity: 0, x: -20, scale: 1 }}
                                                                    transition={{ duration: 0.3 }}
                                                                    style={{
                                                                        color: isInView ? '#ffffff' : '#71717a'
                                                                    }}
                                                                >
                                                                    {exp.title}
                                                                </motion.h4>
                                                                <motion.p 
                                                                    className="text-zinc-500 max-w-lg leading-relaxed group-hover/exp:text-zinc-400 transition-colors duration-500"
                                                                    initial={{ opacity: 0 }}
                                                                    animate={isInView ? { opacity: 1 } : { opacity: 0 }}
                                                                    transition={{ duration: 0.3 }}
                                                                    style={{
                                                                        color: isInView ? '#71717a' : '#3f3f46'
                                                                    }}
                                                                >
                                                                    {exp.summary}
                                                                </motion.p>
                                                                
                                                                {/* 点击提示文字 - 始终显示在底部，不遮挡内容 */}
                                                                <div className="mt-4 flex items-center gap-2 opacity-50 group-hover/exp:opacity-100 transition-opacity duration-500">
                                                                    <span className="text-[10px] uppercase tracking-wider text-zinc-500 group-hover/exp:text-zinc-400">Tap for details</span>
                                                                    <svg className="w-3 h-3 text-zinc-500 group-hover/exp:text-zinc-400 transition-colors duration-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                                    </svg>
                                                                </div>
                                                    </div>
                                                    <div className="flex gap-3 items-start flex-shrink-0">
                                                        {exp.images && exp.images.map((img, idx) => (
                                                            <div key={idx} onClick={(e) => {
                                                                handleClickEffect(e);
                                                                setActiveExpModal({...exp, selectedImage: img});
                                                            }} className={`cursor-pointer active:scale-95 transition-all duration-500 ${imagesLoaded ? 'opacity-100' : 'opacity-0 scale-95'}`}>
                                                                <img 
                                                                    src={img} 
                                                                    alt={exp.title}
                                                                    className="w-20 h-20 md:w-24 md:h-24 object-cover rounded-lg grayscale hover:grayscale-0 transition-all duration-300 border border-white/10"
                                                                            style={{
                                                                                filter: 'brightness(0.6) grayscale(100%)',
                                                                                transition: 'filter 0.3s ease'
                                                                            }}
                                                                            onMouseEnter={(e) => {
                                                                                e.target.style.filter = 'brightness(0.8) grayscale(0%)';
                                                                            }}
                                                                            onMouseLeave={(e) => {
                                                                                e.target.style.filter = 'brightness(0.6) grayscale(100%)';
                                                                            }}
                                                                />
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                                        
                                                        {/* 底部分割線 */}
                                                        {!isLast && (
                                                            <motion.div 
                                                                className="mt-8 md:mt-12 h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"
                                                                initial={{ scaleX: 0 }}
                                                                animate={isInView ? { scaleX: 1 } : { scaleX: 0 }}
                                                                transition={{ duration: 0.3 }}
                                                            ></motion.div>
                                                        )}
                                                    </motion.div>
                                                </motion.div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </section>

                            <section id="certs" className="mb-8 relative overflow-visible">
                                <div className="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-white/5 to-transparent"></div>
                                
                                <div className="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-8 border-t border-white/5 pt-8 mt-8">
                                    <h2 className="text-4xl font-light text-white">CERTIFICATE</h2>
                                    <p className="text-zinc-500 text-sm max-w-sm">跨足專案管理、數據分析與金融實務。</p>
                                </div>
                                <div className="space-y-12">
                                            <motion.div
                                                initial={{ opacity: 0, y: 50 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        transition={{ duration: 0.3 }}
                                        className="relative group"
                                    >
                                        <div className="relative">
                                            {/* 3D卡牌輪播容器 */}
                                            <div className="cert-cards-container" ref={certCardsContainerRef}>
                                                <div className="cert-cards-wrapper">
                                                    {allCertificates.map((cert, certIdx) => {
                                                        // 計算循環偏移量
                                                        let offset = certIdx - certPageIndex;
                                                        
                                                        // 處理循環：當在第一張時，最后一張應該在左側
                                                        if (certPageIndex === 0 && certIdx === allCertificates.length - 1) {
                                                            offset = -1;
                                                        }
                                                        // 處理循環：當在最后一張時，第一張應該在右側
                                                        else if (certPageIndex === allCertificates.length - 1 && certIdx === 0) {
                                                            offset = 1;
                                                        }
                                                        
                                                        const isActive = offset === 0;
                                                        const isLeft = offset === -1;
                                                        const isRight = offset === 1;
                                                        const isVisible = Math.abs(offset) <= 1 || 
                                                            (certPageIndex === 0 && certIdx === allCertificates.length - 1) ||
                                                            (certPageIndex === allCertificates.length - 1 && certIdx === 0);
                                                        
                                                        // 計算位置和變換
                                                        let transform = '';
                                                        let zIndex = 0;
                                                        let opacity = 0;
                                                        
                                                        if (isActive) {
                                                            // 中間：浮起來
                                                            transform = 'translateX(0) translateY(-15px) translateZ(0) scale(1)';
                                                            zIndex = 100;
                                                            opacity = 1;
                                                        } else if (isLeft) {
                                                            // 左側：降下去
                                                            transform = 'translateX(-190px) translateY(25px) translateZ(-70px) scale(0.85) rotateY(15deg)';
                                                            zIndex = 90;
                                                            opacity = 0.6;
                                                        } else if (isRight) {
                                                            // 右側：降下去
                                                            transform = 'translateX(190px) translateY(25px) translateZ(-70px) scale(0.85) rotateY(-15deg)';
                                                            zIndex = 90;
                                                            opacity = 0.6;
                                                        } else {
                                                            opacity = 0;
                                                        }
                                                        
                                                        return (
                                                            <div
                                                            key={cert.id}
                                                                className="cert-card"
                                                            style={{
                                                                    transform: transform,
                                                                    zIndex: zIndex,
                                                                    opacity: opacity,
                                                                    pointerEvents: isVisible ? 'auto' : 'none'
                                                                }}
                                                                onClick={(e) => {
                                                                    if (isActive) {
                                                                        handleClickEffect(e);
                                                                        setActiveCertModal({...cert, category: cert.category});
                                                                    } else if (isVisible) {
                                                                        // 點擊左右卡片可以滑動
                                                                        handleCertSlide(offset > 0 ? 'next' : 'prev');
                                                                    }
                                                                }}
                                                            >
                                                                <div className={`cert-card-content transition-all duration-700 ${imagesLoaded ? 'opacity-100 scale-100' : 'opacity-0 scale-90'}`}>
                                                                    {cert.image && (
                                                                        <img 
                                                                            src={cert.image} 
                                                                            alt={cert.title}
                                                                            className={`cert-card-image ${cert.needsRotation ? 'rotate-left-90' : ''}`}
                                                                        />
                                                                    )}
                                                                    <div className="cert-card-info">
                                                                        <h3 className="cert-card-title">{cert.title}</h3>
                                                                        <p className="cert-card-issuer">{cert.issuer}</p>
                                                                        {cert.desc && (
                                                                            <p className="cert-card-desc">{cert.desc}</p>
                                                                            )}
                                                    </div>
                                            </div>
                                        </div>
                                                        );
                                                    })}
                                                                    </div>
                                                                </div>
                                            
                                            {/* 滑動按鈕 */}
                                            <div className="flex items-center justify-center gap-4 mt-8">
                                                <button
                                                    onClick={() => handleCertSlide('prev')}
                                                    className="w-12 h-12 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 cursor-pointer hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm"
                                                    aria-label="上一張"
                                                >
                                                    <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                                    </svg>
                                                </button>
                                                
                                                <div className="text-zinc-400 text-sm min-w-[60px] text-center">
                                                    {certPageIndex + 1} / {allCertificates.length}
                                                            </div>
                                                
                                                <button
                                                    onClick={() => handleCertSlide('next')}
                                                    className="w-12 h-12 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 cursor-pointer hover:scale-110 transition-all duration-300 flex items-center justify-center backdrop-blur-sm"
                                                    aria-label="下一張"
                                                >
                                                    <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
                                                    </svg>
                                                </button>
                                            </div>
                                                </div>
                                            </motion.div>
                                </div>
                            </section>

                            <footer className="py-32 border-t border-white/5 text-center">
                                <div className="text-[12vw] font-serif italic text-white/5 pointer-events-none select-none">Stay Forward.</div>
                                <div className="flex items-center justify-center gap-6 mt-12">
                                    {/* LinkedIn */}
                                    <a 
                                        href="https://linkedin.com/in/youwei-chen-76b95235a" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        onClick={handleClickEffect}
                                        className="w-10 h-10 flex items-center justify-center rounded-full border border-white/10 hover:border-white/30 hover:bg-white/5 transition-all duration-300 group cursor-pointer active:scale-90"
                                        aria-label="LinkedIn"
                                    >
                                        <svg className="w-5 h-5 text-zinc-400 group-hover:text-white transition-colors" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                                        </svg>
                                    </a>
                                    
                                    {/* Email */}
                                    <a 
                                        href="mailto:david8015838@gmail.com" 
                                        onClick={handleClickEffect}
                                        className="w-10 h-10 flex items-center justify-center rounded-full border border-white/10 hover:border-white/30 hover:bg-white/5 transition-all duration-300 group cursor-pointer active:scale-90"
                                        aria-label="Email"
                                    >
                                        <svg className="w-5 h-5 text-zinc-400 group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                        </svg>
                                    </a>
                                    
                                    {/* Threads */}
                                    <a 
                                        href="https://www.threads.com/@___cuw___?igshid=NTc4MTIwNjQ2YQ==" 
                                        target="_blank" 
                                        rel="noopener noreferrer"
                                        onClick={handleClickEffect}
                                        className="w-10 h-10 flex items-center justify-center rounded-full border border-white/10 hover:border-white/30 hover:bg-white/5 transition-all duration-300 group cursor-pointer active:scale-90"
                                        aria-label="Threads"
                                    >
                                        <img src={IMAGES.iconThreads} alt="Threads" className="w-5 h-5 opacity-60 group-hover:opacity-100 transition-opacity" />
                                    </a>
                                </div>
                            </footer>
                        </main>
                    </div>

                    {/* Modals */}
                    <AnimatePresence>
                        {/* Project Info Modal - 功能介紹 */}
                        {activeProjectInfo && (
                            <motion.div 
                                key="proj-info-modal" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                className="fixed inset-0 z-[210] flex items-center justify-center p-4 md:p-6"
                                onAnimationStart={() => document.body.classList.add('modal-open')}
                                onExitComplete={() => {
                                    setTimeout(() => {
                                        document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                        setActiveProjectInfo(null);
                                    }, 100);
                                }}
                            >
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl cursor-pointer" onClick={(e) => {
                                    handleClickEffect(e);
                                    setActiveProjectInfo(null);
                                    setTimeout(() => {
                                        document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    }, 100);
                                }} />
                                <motion.div 
                                        initial={{ scale: 0.9, opacity: 0, y: 20 }} 
                                        animate={{ scale: 1, opacity: 1, y: 0 }} 
                                        exit={{ scale: 0.9, opacity: 0, y: 20 }} 
                                        transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }}
                                    className="relative max-w-[95vw] lg:max-w-4xl w-full max-h-[90vh] bg-gradient-to-br from-zinc-900 via-zinc-900 to-zinc-950 border border-white/10 rounded-[2.5rem] p-6 md:p-12 lg:p-16 overflow-y-auto custom-scrollbar backdrop-blur-xl shadow-2xl"
                                    style={{
                                        position: 'relative',
                                        isolation: 'isolate'
                                    }}
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    {/* 背景光暈效果 */}
                                    <div className="absolute inset-0 bg-gradient-to-r from-blue-500/0 via-purple-500/5 to-cyan-500/0 opacity-50 rounded-[2.5rem]"></div>
                                    
                                    {/* 邊框光效 */}
                                    <div className="absolute -inset-[1px] rounded-[2.5rem] bg-gradient-to-r from-blue-500/0 via-purple-500/10 to-cyan-500/0 opacity-50 blur-xl -z-10"></div>
                                    
                                    <div className="relative z-10">
                                        <div className="flex justify-between items-start mb-8 md:mb-12">
                                            <h2 className="text-2xl md:text-4xl font-light text-white">{activeProjectInfo.title}</h2>
                                            <button onClick={(e) => {
                                                handleClickEffect(e);
                                                setActiveProjectInfo(null);
                                                setTimeout(() => {
                                                    document.body.classList.remove('modal-open');
                                                    document.body.style.overflow = '';
                                                    document.body.style.position = '';
                                                    document.body.style.width = '';
                                                    document.body.style.height = '';
                                                }, 100);
                                            }} className="text-3xl font-thin hover:text-white transition hover:rotate-90 duration-300 cursor-pointer active:scale-90">×</button>
                                        </div>
                                        
                                        <p className="text-zinc-400 text-base md:text-lg mb-8 md:mb-12 leading-relaxed">{activeProjectInfo.desc}</p>
                                        
                                        <div className="mb-8 md:mb-12">
                                            <h3 className="text-lg md:text-xl font-light text-white mb-6">功能特色</h3>
                                            <ul className="space-y-3 md:space-y-4">
                                                {activeProjectInfo.features.map((feature, idx) => (
                                                    <motion.li 
                                                        key={idx}
                                                        initial={{ opacity: 0, x: -20 }}
                                                        animate={{ opacity: 1, x: 0 }}
                                                        transition={{ duration: 0.3 }}
                                                        className="text-zinc-400 text-sm md:text-base flex items-start gap-3"
                                                    >
                                                        <span className="text-white/30 mt-1">•</span>
                                                        <span>{feature}</span>
                                                    </motion.li>
                                                ))}
                                            </ul>
                                        </div>
                                        
                                        <div className="flex justify-center pt-4">
                                            <motion.button
                                                onClick={(e) => {
                                                    handleClickEffect(e);
                                                    // 先关闭功能介绍modal
                                                    setActiveProjectInfo(null);
                                                    // 然后直接打开小程序视图
                                                    setTimeout(() => {
                                                        setActiveProjectView(activeProjectInfo);
                                                        document.body.classList.remove('modal-open');
                                                        document.body.style.overflow = '';
                                                        document.body.style.position = '';
                                                        document.body.style.width = '';
                                                        document.body.style.height = '';
                                                    }, 300);
                                                }}
                                                className="px-8 md:px-12 py-3 md:py-4 bg-gradient-to-r from-white/10 to-white/5 border border-white/20 rounded-full text-white font-medium text-sm md:text-base uppercase tracking-wider hover:from-white/20 hover:to-white/10 transition-all duration-500 hover:scale-105 hover:shadow-[0_8px_32px_0_rgba(255,255,255,0.1)] cursor-pointer"
                                                whileHover={{ scale: 1.05 }}
                                                whileTap={{ scale: 0.95 }}
                                            >
                                                Try it now!
                                            </motion.button>
                                        </div>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}

                        {activeProjectModal && (
                            <motion.div 
                                key="proj-modal" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                className="fixed inset-0 z-[200] flex items-center justify-center p-4 md:p-6"
                                onAnimationStart={() => document.body.classList.add('modal-open')}
                                onExitComplete={() => {
                                    setTimeout(() => {
                                    document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    setActiveProjectModal(false);
                                    }, 100);
                                }}
                            >
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl" onClick={() => {
                                    setActiveProjectModal(false);
                                    setTimeout(() => {
                                    document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    }, 100);
                                }} />
                                <motion.div 
                                    initial={{ scale: 0.9, opacity: 0, y: 20 }} 
                                    animate={{ scale: 1, opacity: 1, y: 0 }} 
                                    exit={{ scale: 0.9, opacity: 0, y: 20 }} 
                                    transition={{ duration: 0.3, ease: [0.25, 0.1, 0.25, 1] }}
                                    className="relative max-w-[95vw] lg:max-w-6xl w-full max-h-[90vh] bg-gradient-to-br from-zinc-900 via-zinc-900 to-zinc-950 border border-white/10 rounded-[2.5rem] p-6 md:p-12 lg:p-20 overflow-y-auto custom-scrollbar backdrop-blur-xl shadow-2xl"
                                    style={{
                                        position: 'relative',
                                        isolation: 'isolate'
                                    }}
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    {/* 背景光暈效果 */}
                                    <div className="absolute inset-0 bg-gradient-to-r from-blue-500/0 via-purple-500/5 to-cyan-500/0 opacity-0 group-hover:opacity-100 transition-opacity duration-700 rounded-[2.5rem]"></div>
                                    
                                    {/* 裝飾性網格背景 */}
                                    <div className="absolute inset-0 opacity-[0.03] rounded-[2.5rem]" style={{
                                        backgroundImage: 'linear-gradient(rgba(255,255,255,0.15) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.15) 1px, transparent 1px)',
                                        backgroundSize: '30px 30px',
                                        backgroundPosition: '0 0, 0 0'
                                    }}></div>
                                    
                                    {/* 邊框光效 */}
                                    <div className="absolute -inset-[1px] rounded-[2.5rem] bg-gradient-to-r from-blue-500/0 via-purple-500/10 to-cyan-500/0 opacity-50 blur-xl -z-10"></div>
                                    
                                    <div className="relative z-10">
                                    <div className="flex justify-between items-start mb-12 md:mb-20">
                                        <h2 className="text-3xl md:text-5xl font-light text-white">Project Matrix</h2>
                                        <button onClick={(e) => {
                                            handleClickEffect(e);
                                            setActiveProjectModal(false);
                                                setTimeout(() => {
                                            document.body.classList.remove('modal-open');
                                                    document.body.style.overflow = '';
                                                    document.body.style.position = '';
                                                    document.body.style.width = '';
                                                    document.body.style.height = '';
                                                }, 100);
                                            }} className="text-3xl font-thin hover:text-white transition hover:rotate-90 duration-300 cursor-pointer active:scale-90">×</button>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                                        {projects.map((p, idx) => (
                                            <motion.div 
                                                key={p.id} 
                                                initial={{ opacity: 0, y: 20 }}
                                                animate={{ opacity: 1, y: 0 }}
                                                transition={{ duration: 0.3 }}
                                                className="group p-8 md:p-10 border border-white/5 rounded-3xl hover:bg-white/[0.02] cursor-pointer transition-all relative overflow-hidden backdrop-blur-sm active:scale-[0.98]"
                                                style={{
                                                    position: 'relative',
                                                    isolation: 'isolate'
                                                }}
                                                onClick={(e) => {
                                                    handleClickEffect(e);
                                                    setActiveProjectInfo(p);
                                                setActiveProjectModal(false);
                                                }}
                                            >
                                                {/* 卡片光效 */}
                                                <div className="absolute inset-0 bg-gradient-to-br from-white/0 via-white/0 to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-700 rounded-3xl"></div>
                                                
                                                <div className="relative z-10">
                                                    <h4 className="text-xl md:text-2xl font-light mb-2 text-white group-hover:translate-x-1 transition-transform">{p.title}</h4>
                                                    <p className="text-zinc-500 text-sm group-hover:text-zinc-400 transition-colors">{p.desc}</p>
                                            </div>
                                            </motion.div>
                                        ))}
                                        </div>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}

                        {(activeExpModal || activeCertModal) && (
                            <motion.div 
                                key="info-modal" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }}
                                transition={{ duration: 0.3 }}
                                className="fixed inset-0 z-[200] flex items-center justify-center p-4 md:p-6"
                                style={{ isolation: 'isolate' }}
                            >
                                {/* 深色背景遮罩 - 增強模糊 */}
                                <motion.div 
                                    initial={{ opacity: 0, backdropFilter: 'blur(0px)' }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    transition={{ duration: 0.3 }}
                    className="absolute inset-0 bg-gradient-to-br from-black/70 via-black/80 to-black/70 cursor-pointer"
                    style={{
                        backdropFilter: 'blur(20px)',
                        WebkitBackdropFilter: 'blur(20px)',
                        willChange: 'opacity',
                        transform: 'translateZ(0)'
                    }}
                                    onClick={(e) => {
                                        handleClickEffect(e);
                                        setActiveExpModal(null);
                                        setActiveCertModal(null);
                                    }} 
                                />
                                
                                {/* 玻璃態模態框 */}
                                <motion.div 
                                    initial={{ y: 30, opacity: 0, scale: 0.97 }}
                                    animate={{ y: 0, opacity: 1, scale: 1 }}
                                    exit={{ y: 30, opacity: 0, scale: 0.97 }}
                                    transition={{ 
                                        duration: 0.3,
                                        ease: [0.4, 0, 0.2, 1]
                                    }}
                                    className="relative max-w-5xl w-full max-h-[90vh] md:max-h-[85vh] overflow-hidden rounded-[3rem] flex flex-col lg:flex-row backdrop-blur-2xl"
                                    style={{
                                        background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.08) 100%)',
                                        border: '1px solid rgba(255, 255, 255, 0.15)',
                                        boxShadow: `
                                            inset 0 1px 2px 0 rgba(255, 255, 255, 0.2),
                                            0 20px 60px 0 rgba(0, 0, 0, 0.8),
                                            0 8px 30px 0 rgba(0, 0, 0, 0.6),
                                            0 0 0 1px rgba(255, 255, 255, 0.05)
                                        `,
                                        backdropFilter: 'blur(20px)',
                                        WebkitBackdropFilter: 'blur(20px)',
                                        position: 'relative',
                                        isolation: 'isolate',
                                        willChange: 'transform, opacity',
                                        transform: 'translateZ(0)'
                                    }}
                                >
                                    {/* 玻璃反射光效 */}
                                    <div className="absolute inset-0 bg-gradient-to-br from-white/[0.12] via-transparent to-transparent opacity-30 pointer-events-none z-10" />
                                    <div className="absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-white/[0.08] to-transparent opacity-20 pointer-events-none z-10" />
                                    <div className="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-white/[0.06] to-transparent opacity-15 pointer-events-none z-10" />
                                    
                                    {/* 邊框光暈 */}
                                    <div 
                                        className="absolute inset-0 rounded-[3rem] pointer-events-none z-0"
                                        style={{
                                            background: 'linear-gradient(135deg, rgba(96, 165, 250, 0.15) 0%, rgba(167, 139, 250, 0.1) 50%, rgba(96, 165, 250, 0.15) 100%)',
                                            padding: '1px',
                                            WebkitMask: 'linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)',
                                            WebkitMaskComposite: 'xor',
                                            maskComposite: 'exclude'
                                        }}
                                    />
                                    
                                    {/* 圖片區域 - 玻璃態設計 */}
                                    <div 
                                        className="lg:w-1/2 h-64 lg:h-auto relative overflow-hidden flex items-center justify-center p-6 md:p-8"
                                        style={{
                                            background: 'linear-gradient(135deg, rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.15) 100%)',
                                            backdropFilter: 'blur(10px)',
                                            WebkitBackdropFilter: 'blur(10px)',
                                            borderRight: '1px solid rgba(255, 255, 255, 0.08)',
                                            willChange: 'transform',
                                            transform: 'translateZ(0)'
                                        }}
                                    >
                                        {/* 圖片區域背景光效 */}
                                        <div className="absolute inset-0 bg-gradient-to-br from-blue-500/[0.03] via-purple-500/[0.02] to-cyan-500/[0.03] pointer-events-none" />
                                        <div className="absolute inset-0 bg-radial-gradient(circle at center, rgba(255, 255, 255, 0.05) 0%, transparent 70%) pointer-events-none" />
                                        
                                        {activeExpModal?.images && activeExpModal.images.length > 1 ? (
                                            <div className="w-full h-full flex flex-col gap-4 overflow-y-auto custom-scrollbar z-10">
                                                {activeExpModal.images.map((img, idx) => (
                                                    <motion.img 
                                                        key={idx}
                                                        initial={{ opacity: 0, scale: 0.9 }}
                                                        animate={{ opacity: imagesLoaded ? 1 : 0, scale: imagesLoaded ? 1 : 0.9 }}
                                                        transition={{ duration: 0.3 }}
                                                        src={img} 
                                                        className="w-full object-contain rounded-xl"
                                                        style={{ 
                                                            maxHeight: activeExpModal.images.length > 1 ? 'calc(50% - 8px)' : '100%',
                                                            filter: 'drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5))',
                                                            boxShadow: '0 0 40px rgba(255, 255, 255, 0.1)'
                                                        }}
                                                    />
                                                ))}
                                            </div>
                                        ) : (
                                        <motion.img 
                                            initial={{ opacity: 0, scale: 0.9 }}
                                            animate={{ opacity: imagesLoaded ? 1 : 0, scale: imagesLoaded ? 1 : 0.9 }}
                                            transition={{ duration: 0.3 }}
                                            src={(activeExpModal?.selectedImage || activeExpModal?.image || activeCertModal?.image)} 
                                            className="w-full h-full object-contain z-10"
                                            style={{ 
                                                transform: (activeCertModal?.needsRotation) ? 'rotate(-90deg)' : 'none',
                                                transition: 'transform 0.3s',
                                                filter: 'drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5))',
                                                boxShadow: '0 0 40px rgba(255, 255, 255, 0.1)'
                                            }}
                                        />
                                        )}
                                    </div>
                                    
                                    {/* 內容區域 - 精緻玻璃態 */}
                                    <div 
                                        className="lg:w-1/2 p-8 md:p-12 lg:p-16 overflow-y-auto custom-scrollbar relative z-10"
                                        style={{
                                            background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.02) 0%, rgba(255, 255, 255, 0.01) 100%)'
                                        }}
                                    >
                                        {/* 關閉按鈕 - 精緻設計 */}
                                        <motion.button 
                                            whileHover={{ scale: 1.1, rotate: 90 }}
                                            whileTap={{ scale: 0.9 }}
                                            onClick={(e) => {
                                                handleClickEffect(e);
                                                setActiveExpModal(null);
                                                setActiveCertModal(null);
                                            }}
                                            className="absolute top-6 right-6 w-10 h-10 flex items-center justify-center text-white/70 hover:text-white transition-all duration-300 rounded-full backdrop-blur-sm border border-white/10 hover:border-white/20 hover:bg-white/5 cursor-pointer z-20"
                                            style={{
                                                backdropFilter: 'blur(10px)',
                                                WebkitBackdropFilter: 'blur(10px)',
                                                boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)'
                                            }}
                                        >
                                            <span className="text-2xl font-light">×</span>
                                        </motion.button>
                                        
                                        {/* 標籤 */}
                                        <motion.span 
                                            initial={{ opacity: 0, x: -20 }}
                                            animate={{ opacity: 1, x: 0 }}
                                            transition={{ duration: 0.3 }}
                                            className="inline-block text-[10px] font-bold tracking-[0.3em] uppercase text-zinc-400 mb-2 px-3 py-1 rounded-full border border-white/10 bg-white/5 backdrop-blur-sm"
                                        >
                                            {(activeExpModal || activeCertModal).tag || (activeExpModal || activeCertModal).category}
                                        </motion.span>
                                        
                                        {/* 標題 */}
                                        <motion.h2 
                                            initial={{ opacity: 0, y: 20 }}
                                            animate={{ opacity: 1, y: 0 }}
                                            transition={{ duration: 0.3 }}
                                            className="text-4xl md:text-5xl font-light text-white my-4 leading-tight"
                                            style={{
                                                textShadow: '0 2px 20px rgba(255, 255, 255, 0.1)'
                                            }}
                                        >
                                            {(activeExpModal || activeCertModal).title}
                                        </motion.h2>
                                        
                                        {/* 副標題 */}
                                        {(activeExpModal || activeCertModal).subtitle && (
                                            <motion.p 
                                                initial={{ opacity: 0, y: 20 }}
                                                animate={{ opacity: 1, y: 0 }}
                                                transition={{ duration: 0.3 }}
                                                className="text-xl font-light text-zinc-300 mb-6"
                                                style={{
                                                    textShadow: '0 1px 10px rgba(0, 0, 0, 0.5)'
                                                }}
                                            >
                                                {(activeExpModal || activeCertModal).subtitle}
                                            </motion.p>
                                        )}
                                        
                                        {/* 內容 */}
                                        <motion.p 
                                            initial={{ opacity: 0, y: 20 }}
                                            animate={{ opacity: 1, y: 0 }}
                                            transition={{ duration: 0.3 }}
                                            className="text-zinc-300 leading-relaxed whitespace-pre-line text-base md:text-lg"
                                            style={{
                                                textShadow: '0 1px 10px rgba(0, 0, 0, 0.3)'
                                            }}
                                        >
                                            {(activeExpModal || activeCertModal).details || (activeExpModal || activeCertModal).desc}
                                        </motion.p>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                    <AnimatePresence>
                        {activeProjectView && (
                            <motion.div 
                                key="proj-view" 
                                initial={{ opacity: 0 }} 
                                animate={{ opacity: 1 }} 
                                exit={{ opacity: 0 }} 
                                className="fixed inset-0 z-[220] flex items-center justify-center"
                                onAnimationStart={() => document.body.classList.add('modal-open')}
                                onExitComplete={() => {
                                    document.body.classList.remove('modal-open');
                                }}
                            >
                                <div className="absolute inset-0 bg-black/80 backdrop-blur-3xl cursor-pointer" onClick={(e) => {
                                    handleClickEffect(e);
                                    // 返回 Project Matrix 页面
                                    setActiveProjectView(null);
                                    setActiveProjectModal(true);
                                    setTimeout(() => {
                                    document.body.classList.remove('modal-open');
                                        document.body.style.overflow = '';
                                        document.body.style.position = '';
                                        document.body.style.width = '';
                                        document.body.style.height = '';
                                    }, 100);
                                }} />
                                <motion.div 
                                    initial={{ y: 40, opacity: 0 }} 
                                    animate={{ y: 0, opacity: 1 }} 
                                    exit={{ y: 40, opacity: 0 }} 
                                    className="relative w-[95vw] h-[95vh] max-w-[98vw] max-h-[98vh] overflow-hidden flex flex-col rounded-[3rem] backdrop-blur-2xl"
                                    style={{
                                        background: 'linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%)',
                                        border: '1px solid rgba(255, 255, 255, 0.2)',
                                        boxShadow: '0 8px 32px 0 rgba(0, 0, 0, 0.37), inset 0 0 0 1px rgba(255, 255, 255, 0.1)'
                                    }}
                                    onClick={(e) => e.stopPropagation()}
                                >
                                    {/* 玻璃效果光晕 */}
                                    <div className="absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-transparent rounded-[3rem] pointer-events-none"></div>
                                    
                                    {/* 边框高光效果 */}
                                    <div className="absolute -inset-[1px] bg-gradient-to-r from-white/20 via-white/10 to-white/20 rounded-[3rem] opacity-50 blur-sm pointer-events-none -z-10"></div>
                                    
                                    {/* 右上角返回按钮 */}
                                    <div className="absolute top-6 right-6 z-50 flex-shrink-0">
                                        <button 
                                            onClick={(e) => {
                                                handleClickEffect(e);
                                                // 返回 Project Matrix 页面
                                            setActiveProjectView(null);
                                            setActiveProjectModal(true);
                                                setTimeout(() => {
                                            document.body.classList.remove('modal-open');
                                                    document.body.style.overflow = '';
                                                    document.body.style.position = '';
                                                    document.body.style.width = '';
                                                    document.body.style.height = '';
                                                }, 100);
                                            }} 
                                            className="px-5 py-2.5 bg-white/10 hover:bg-white/20 border border-white/30 rounded-xl text-white text-sm font-medium transition-all duration-300 hover:scale-105 backdrop-blur-md shadow-lg cursor-pointer active:scale-95"
                                            style={{
                                                boxShadow: '0 4px 16px rgba(0, 0, 0, 0.2), inset 0 0 0 1px rgba(255, 255, 255, 0.1)'
                                            }}
                                        >
                                            ← 返回
                                        </button>
                                    </div>
                                    
                                    {/* 小程序内容区域 - 占据全屏 */}
                                    <div className="flex-1 overflow-hidden min-h-0 w-full h-full rounded-[3rem]">
                                        <div className="bg-transparent overflow-hidden relative w-full h-full rounded-[3rem]">
                                            <div className="absolute inset-0 flex items-center justify-center rounded-[3rem]" style={{ 
                                                width: '100%',
                                                height: '100%'
                                            }}>
                                                <div 
                                                    className="rounded-[2.5rem] overflow-hidden shadow-2xl"
                                                    style={{
                                                        width: `${100 / iframeScale}%`,
                                                        height: `${100 / iframeScale}%`,
                                                        transform: `scale(${iframeScale})`,
                                                        transformOrigin: 'center center',
                                                        position: 'relative',
                                                        boxShadow: '0 20px 60px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.1)'
                                                    }}
                                                >
                                                    <iframe 
                                                        ref={iframeRef}
                                                        src={activeProjectView.url + (activeProjectView.demoData ? '?demo=true&source=portfolio' : '')} 
                                                        className="border-0 bg-white w-full h-full rounded-[2.5rem]" 
                                                        style={{ 
                                                            width: '100%',
                                                            height: '100%',
                                                            minHeight: '100%',
                                                            pointerEvents: 'auto',
                                                            display: 'block'
                                                        }}
                                                        allow="fullscreen"
                                                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-modals allow-top-navigation allow-pointer-lock"
                                                    />
                                        </div>
                                            </div>
                                        </div>
                                    </div>
                                </motion.div>
                            </motion.div>
                        )}
                    </AnimatePresence>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
